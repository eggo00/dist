{"version":3,"file":"index-HjVkXGHD.js","sources":["../../src/utils/Constants.ts","../../src/entities/Player.ts","../../src/entities/Obstacle.ts","../../src/entities/Collectible.ts","../../src/systems/LevelGenerator.ts","../../src/systems/CollisionSystem.ts","../../src/utils/ObjectPool.ts","../../src/scenes/GameScene.ts","../../src/systems/InputManager.ts","../../src/systems/ScoreSystem.ts","../../src/systems/PowerUpSystem.ts","../../src/systems/HealthSystem.ts","../../src/systems/AudioManager.ts","../../src/ui/UIManager.ts","../../src/Game.ts","../../src/main.ts"],"sourcesContent":["// Game Constants Configuration\n\nexport const GAME_CONFIG = {\n  // Lane settings\n  LANE_COUNT: 3,\n  LANE_WIDTH: 3,\n  LANE_POSITIONS: [3, 0, -3], // Left, Center, Right\n\n  // Player settings\n  PLAYER_START_LANE: 1, // Center lane\n  PLAYER_HEIGHT: 1,\n  PLAYER_RADIUS: 0.5,\n  JUMP_FORCE: 12,\n  GRAVITY: -30,\n  SLIDE_DURATION: 0.6, // seconds\n  SLIDE_HEIGHT: 0.5,\n  LANE_SWITCH_SPEED: 15,\n\n  // Game speed\n  BASE_SPEED: 15,\n  MAX_SPEED: 40,\n  SPEED_INCREMENT: 0.5,\n  SPEED_INCREMENT_INTERVAL: 10, // Every 10 segments\n\n  // Level generation\n  SEGMENT_LENGTH: 20,\n  SEGMENTS_AHEAD: 5,\n  INITIAL_SEGMENTS: 8,\n\n  // Collectibles\n  COIN_VALUE: 10,\n  FISH_VALUE: 50,\n  COIN_MAGNET_RANGE: 5,\n\n  // Power-ups\n  MAGNET_DURATION: 10, // seconds\n  MULTIPLIER_DURATION: 15,\n  SHIELD_DURATION: 8,\n\n  // Difficulty\n  OBSTACLE_BASE_PROBABILITY: 0.4,\n  OBSTACLE_MAX_PROBABILITY: 0.7,\n  DIFFICULTY_CURVE_RATE: 0.02,\n\n  // Camera\n  CAMERA_FOV: 60,\n  CAMERA_NEAR: 0.1,\n  CAMERA_FAR: 1000,\n  CAMERA_OFFSET_Y: 3.5,\n  CAMERA_OFFSET_Z: -8,\n  CAMERA_LOOK_AHEAD: 5,\n\n  // Performance\n  MAX_POOL_SIZE: 50,\n  SHADOW_MAP_SIZE: 1024,\n  ENABLE_SHADOWS: true,\n\n  // UI\n  COMBO_TIMEOUT: 2000, // ms\n  SCORE_PER_METER: 1,\n};\n\n// Use relative paths for assets in public folder (works with base path)\nconst BASE_PATH = '/cat_runrun';\n\nexport const ASSET_PATHS = {\n  MODELS: {\n    CAT: `${BASE_PATH}/models/cat.glb`,\n    OBSTACLE_BARREL: `${BASE_PATH}/models/barrel.glb`,\n    OBSTACLE_CRATE: `${BASE_PATH}/models/crate.glb`,\n    OBSTACLE_HURDLE: `${BASE_PATH}/models/hurdle.glb`,\n    COIN: `${BASE_PATH}/models/coin.glb`,\n    FISH: `${BASE_PATH}/models/fish.glb`,\n    POWERUP_MAGNET: `${BASE_PATH}/models/magnet.glb`,\n    POWERUP_MULTIPLIER: `${BASE_PATH}/models/multiplier.glb`,\n    POWERUP_SHIELD: `${BASE_PATH}/models/shield.glb`,\n  },\n  TEXTURES: {\n    GROUND: `${BASE_PATH}/textures/ground.png`,\n    SKY: `${BASE_PATH}/textures/sky.png`,\n  },\n  SOUNDS: {\n    JUMP: `${BASE_PATH}/sounds/jump.wav`,\n    COIN: `${BASE_PATH}/sounds/coin.wav`,\n    FISH: `${BASE_PATH}/sounds/fish.wav`,\n    HIT: `${BASE_PATH}/sounds/hit.wav`,\n    POWERUP: `${BASE_PATH}/sounds/powerup.wav`,\n    BGM: `${BASE_PATH}/sounds/bgm-temp.wav`,\n  },\n};\n\nexport const COLORS = {\n  GROUND: 0x90C695,\n  SKY_TOP: 0x87CEEB,\n  SKY_BOTTOM: 0xE0F6FF,\n  OBSTACLE: 0x8B4513,\n  COIN: 0xFFD700,\n  FISH: 0xFF69B4,\n  POWERUP_MAGNET: 0x4169E1,\n  POWERUP_MULTIPLIER: 0xFF4500,\n  POWERUP_SHIELD: 0x00CED1,\n};\n\nexport const ANIMATION_NAMES = {\n  IDLE: 'idle',\n  RUN: 'run',\n  JUMP: 'jump',\n  SLIDE: 'slide',\n  HIT: 'hit',\n};\n\nexport enum GameState {\n  MENU = 'menu',\n  PLAYING = 'playing',\n  PAUSED = 'paused',\n  GAME_OVER = 'gameOver',\n  LOADING = 'loading',\n}\n\nexport enum PowerUpType {\n  MAGNET = 'magnet',\n  MULTIPLIER = 'multiplier',\n  SHIELD = 'shield',\n}\n\nexport enum ObstacleType {\n  LOW = 'low',      // Can jump over\n  MIDDLE = 'middle', // Can slide under\n  HIGH = 'high',    // Must avoid by switching lanes\n}\n\nexport enum CollectibleType {\n  COIN = 'coin',\n  FISH = 'fish',\n  POWERUP_MAGNET = 'powerup_magnet',\n  POWERUP_MULTIPLIER = 'powerup_multiplier',\n  POWERUP_SHIELD = 'powerup_shield',\n}\n","import * as THREE from 'three';\nimport { PlayerState } from '../types';\nimport { GAME_CONFIG, ANIMATION_NAMES } from '../utils/Constants';\nimport { Collidable } from '../systems/CollisionSystem';\n\nexport class Player implements Collidable {\n  mesh: THREE.Group;\n  private state: PlayerState;\n  private slideTimer: number = 0;\n  private boundingBox: THREE.Box3;\n  private radius: number;\n\n  constructor(scene: THREE.Scene) {\n    this.state = {\n      lane: GAME_CONFIG.PLAYER_START_LANE,\n      targetLane: GAME_CONFIG.PLAYER_START_LANE,\n      position: new THREE.Vector3(\n        GAME_CONFIG.LANE_POSITIONS[GAME_CONFIG.PLAYER_START_LANE],\n        GAME_CONFIG.PLAYER_HEIGHT,\n        0\n      ),\n      velocity: new THREE.Vector3(0, 0, 0),\n      isJumping: false,\n      isSliding: false,\n      isInvincible: false,\n      currentAnimation: ANIMATION_NAMES.RUN,\n    };\n\n    this.mesh = this.createPlaceholderCat();\n    this.mesh.position.copy(this.state.position);\n    scene.add(this.mesh);\n\n    this.boundingBox = new THREE.Box3();\n    this.radius = GAME_CONFIG.PLAYER_RADIUS;\n  }\n\n  /**\n   * Create a placeholder low-poly cat mesh\n   */\n  private createPlaceholderCat(): THREE.Group {\n    const cat = new THREE.Group();\n\n    // Body\n    const bodyGeometry = new THREE.BoxGeometry(0.8, 0.6, 1.2);\n    const bodyMaterial = new THREE.MeshStandardMaterial({ color: 0xffa500 }); // Orange\n    const body = new THREE.Mesh(bodyGeometry, bodyMaterial);\n    body.position.y = 0.3;\n    cat.add(body);\n\n    // Head\n    const headGeometry = new THREE.SphereGeometry(0.4, 8, 8);\n    const head = new THREE.Mesh(headGeometry, bodyMaterial);\n    head.position.set(0, 0.7, 0.5);\n    cat.add(head);\n\n    // Ears\n    const earGeometry = new THREE.ConeGeometry(0.15, 0.3, 4);\n    const leftEar = new THREE.Mesh(earGeometry, bodyMaterial);\n    leftEar.position.set(-0.2, 1.0, 0.5);\n    cat.add(leftEar);\n\n    const rightEar = new THREE.Mesh(earGeometry, bodyMaterial);\n    rightEar.position.set(0.2, 1.0, 0.5);\n    cat.add(rightEar);\n\n    // Tail\n    const tailGeometry = new THREE.CylinderGeometry(0.1, 0.05, 0.8, 6);\n    const tail = new THREE.Mesh(tailGeometry, bodyMaterial);\n    tail.position.set(0, 0.5, -0.6);\n    tail.rotation.x = Math.PI / 4;\n    cat.add(tail);\n\n    // Legs (simple cylinders)\n    const legGeometry = new THREE.CylinderGeometry(0.1, 0.1, 0.5, 6);\n    const legMaterial = new THREE.MeshStandardMaterial({ color: 0xff8c00 }); // Darker orange\n\n    const legs = [\n      [-0.3, 0, 0.4],\n      [0.3, 0, 0.4],\n      [-0.3, 0, -0.2],\n      [0.3, 0, -0.2],\n    ];\n\n    legs.forEach(([x, y, z]) => {\n      const leg = new THREE.Mesh(legGeometry, legMaterial);\n      leg.position.set(x, y, z);\n      cat.add(leg);\n    });\n\n    return cat;\n  }\n\n  /**\n   * Update player state and physics\n   */\n  update(deltaTime: number): void {\n    // Update slide timer\n    if (this.state.isSliding) {\n      this.slideTimer -= deltaTime;\n      if (this.slideTimer <= 0) {\n        this.endSlide();\n      }\n    }\n\n    // Apply gravity\n    if (this.state.position.y > 0 || this.state.velocity.y > 0) {\n      this.state.velocity.y += GAME_CONFIG.GRAVITY * deltaTime;\n      this.state.position.y += this.state.velocity.y * deltaTime;\n\n      // Land on ground\n      if (this.state.position.y <= (this.state.isSliding ? GAME_CONFIG.SLIDE_HEIGHT : GAME_CONFIG.PLAYER_HEIGHT)) {\n        this.state.position.y = this.state.isSliding ? GAME_CONFIG.SLIDE_HEIGHT : GAME_CONFIG.PLAYER_HEIGHT;\n        this.state.velocity.y = 0;\n        this.state.isJumping = false;\n      }\n    }\n\n    // Smoothly move between lanes\n    const targetX = GAME_CONFIG.LANE_POSITIONS[this.state.targetLane];\n    const currentX = this.state.position.x;\n\n    if (Math.abs(targetX - currentX) > 0.01) {\n      const direction = Math.sign(targetX - currentX);\n      const moveAmount = GAME_CONFIG.LANE_SWITCH_SPEED * deltaTime;\n      this.state.position.x += direction * Math.min(moveAmount, Math.abs(targetX - currentX));\n      this.state.lane = this.state.targetLane; // Update current lane when close enough\n    } else {\n      this.state.position.x = targetX;\n      this.state.lane = this.state.targetLane;\n    }\n\n    // Update mesh position\n    this.mesh.position.copy(this.state.position);\n\n    // Simple running animation (bob up and down)\n    if (!this.state.isJumping && !this.state.isSliding) {\n      const bobAmount = Math.sin(Date.now() * 0.01) * 0.05;\n      this.mesh.position.y += bobAmount;\n    }\n\n    // Rotate cat to face forward\n    this.mesh.rotation.y = 0;\n\n    // Update bounding box\n    this.boundingBox.setFromObject(this.mesh);\n  }\n\n  /**\n   * Handle jump input\n   */\n  jump(): boolean {\n    if (!this.state.isJumping && !this.state.isSliding && this.state.position.y <= GAME_CONFIG.PLAYER_HEIGHT + 0.1) {\n      this.state.velocity.y = GAME_CONFIG.JUMP_FORCE;\n      this.state.isJumping = true;\n      this.state.currentAnimation = ANIMATION_NAMES.JUMP;\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Handle slide input\n   */\n  slide(): boolean {\n    if (!this.state.isSliding && !this.state.isJumping) {\n      this.state.isSliding = true;\n      this.slideTimer = GAME_CONFIG.SLIDE_DURATION;\n      this.state.currentAnimation = ANIMATION_NAMES.SLIDE;\n\n      // Scale down the cat for sliding\n      this.mesh.scale.y = 0.5;\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * End slide action\n   */\n  private endSlide(): void {\n    this.state.isSliding = false;\n    this.mesh.scale.y = 1;\n    this.state.currentAnimation = ANIMATION_NAMES.RUN;\n  }\n\n  /**\n   * Move to left lane\n   */\n  moveLeft(): boolean {\n    if (this.state.targetLane > 0) {\n      this.state.targetLane--;\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Move to right lane\n   */\n  moveRight(): boolean {\n    if (this.state.targetLane < GAME_CONFIG.LANE_COUNT - 1) {\n      this.state.targetLane++;\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Set invincibility state (from shield power-up)\n   */\n  setInvincible(invincible: boolean): void {\n    this.state.isInvincible = invincible;\n\n    // Visual feedback for invincibility\n    if (invincible) {\n      this.mesh.traverse(child => {\n        if (child instanceof THREE.Mesh) {\n          (child.material as THREE.MeshStandardMaterial).emissive = new THREE.Color(0x00ffff);\n          (child.material as THREE.MeshStandardMaterial).emissiveIntensity = 0.5;\n        }\n      });\n    } else {\n      this.mesh.traverse(child => {\n        if (child instanceof THREE.Mesh) {\n          (child.material as THREE.MeshStandardMaterial).emissiveIntensity = 0;\n        }\n      });\n    }\n  }\n\n  /**\n   * Play hit animation\n   */\n  hit(): void {\n    this.state.currentAnimation = ANIMATION_NAMES.HIT;\n    // Simple hit effect - flash red\n    this.mesh.traverse(child => {\n      if (child instanceof THREE.Mesh) {\n        const originalColor = (child.material as THREE.MeshStandardMaterial).color.clone();\n        (child.material as THREE.MeshStandardMaterial).color.set(0xff0000);\n        setTimeout(() => {\n          (child.material as THREE.MeshStandardMaterial).color.copy(originalColor);\n        }, 200);\n      }\n    });\n  }\n\n  /**\n   * Get current player state\n   */\n  getState(): Readonly<PlayerState> {\n    return { ...this.state };\n  }\n\n  /**\n   * Get current lane\n   */\n  getLane(): number {\n    return this.state.lane;\n  }\n\n  /**\n   * Check if player is invincible\n   */\n  isInvincible(): boolean {\n    return this.state.isInvincible;\n  }\n\n  /**\n   * Collision interface methods\n   */\n  get position(): THREE.Vector3 {\n    return this.state.position;\n  }\n\n  getBoundingBox(): THREE.Box3 {\n    return this.boundingBox;\n  }\n\n  getRadius(): number {\n    return this.radius;\n  }\n\n  /**\n   * Reset player to starting position\n   */\n  reset(): void {\n    this.state.lane = GAME_CONFIG.PLAYER_START_LANE;\n    this.state.targetLane = GAME_CONFIG.PLAYER_START_LANE;\n    this.state.position.set(\n      GAME_CONFIG.LANE_POSITIONS[GAME_CONFIG.PLAYER_START_LANE],\n      GAME_CONFIG.PLAYER_HEIGHT,\n      0\n    );\n    this.state.velocity.set(0, 0, 0);\n    this.state.isJumping = false;\n    this.state.isSliding = false;\n    this.state.isInvincible = false;\n    this.mesh.scale.set(1, 1, 1);\n  }\n\n  /**\n   * Dispose of player resources\n   */\n  dispose(): void {\n    this.mesh.traverse(child => {\n      if (child instanceof THREE.Mesh) {\n        child.geometry.dispose();\n        if (Array.isArray(child.material)) {\n          child.material.forEach(mat => mat.dispose());\n        } else {\n          child.material.dispose();\n        }\n      }\n    });\n  }\n}\n","import * as THREE from 'three';\nimport { IPoolable, ObstacleType } from '../types';\nimport { GAME_CONFIG, COLORS } from '../utils/Constants';\nimport { Collidable } from '../systems/CollisionSystem';\n\nexport class Obstacle implements IPoolable, Collidable {\n  mesh: THREE.Object3D;\n  private type: ObstacleType;\n  private lane: number = 0;\n  private active: boolean = false;\n  private boundingBox: THREE.Box3;\n  private radius: number = 0.5;\n\n  constructor(type: ObstacleType) {\n    this.type = type;\n    this.mesh = this.createObstacleMesh(type);\n    this.boundingBox = new THREE.Box3();\n    this.mesh.visible = false;\n  }\n\n  /**\n   * Create obstacle mesh based on type\n   */\n  private createObstacleMesh(type: ObstacleType): THREE.Object3D {\n    const material = new THREE.MeshStandardMaterial({\n      color: COLORS.OBSTACLE,\n      roughness: 0.7,\n      metalness: 0.2,\n    });\n\n    let geometry: THREE.BufferGeometry;\n    let mesh: THREE.Mesh;\n\n    switch (type) {\n      case ObstacleType.LOW:\n        // Low obstacle - can jump over\n        geometry = new THREE.BoxGeometry(1, 0.8, 1);\n        mesh = new THREE.Mesh(geometry, material);\n        mesh.position.y = 0.4;\n        break;\n\n      case ObstacleType.MIDDLE:\n        // Middle obstacle - must slide under\n        geometry = new THREE.BoxGeometry(1.5, 0.3, 1.5);\n        mesh = new THREE.Mesh(geometry, material);\n        mesh.position.y = 1.5;\n\n        // Add support pillars\n        const pillarGeometry = new THREE.CylinderGeometry(0.15, 0.15, 1.5, 8);\n        const pillarMaterial = material.clone();\n\n        const leftPillar = new THREE.Mesh(pillarGeometry, pillarMaterial);\n        leftPillar.position.set(-0.6, 0.75, 0);\n        mesh.add(leftPillar);\n\n        const rightPillar = new THREE.Mesh(pillarGeometry, pillarMaterial);\n        rightPillar.position.set(0.6, 0.75, 0);\n        mesh.add(rightPillar);\n        break;\n\n      case ObstacleType.HIGH:\n      default:\n        // High obstacle - must avoid by switching lanes\n        geometry = new THREE.BoxGeometry(1.2, 2, 1.2);\n        mesh = new THREE.Mesh(geometry, material);\n        mesh.position.y = 1;\n        break;\n    }\n\n    // Add some visual variety with rotation\n    mesh.rotation.y = Math.random() * Math.PI * 2;\n\n    return mesh;\n  }\n\n  /**\n   * Initialize obstacle at a specific position\n   */\n  initialize(lane: number, zPosition: number): void {\n    this.lane = lane;\n    this.mesh.position.x = GAME_CONFIG.LANE_POSITIONS[lane];\n    this.mesh.position.z = zPosition;\n    this.mesh.visible = true;\n    this.setActive(true);\n  }\n\n  /**\n   * Update obstacle (mainly for moving backward relative to player)\n   */\n  update(_deltaTime: number): void {\n    if (!this.active) return;\n\n    // Obstacles move backward (player appears to move forward)\n    // This is handled by the world scrolling system\n    this.boundingBox.setFromObject(this.mesh);\n\n    // Calculate radius from bounding box for accurate collision\n    const size = new THREE.Vector3();\n    this.boundingBox.getSize(size);\n    this.radius = Math.max(size.x, size.y, size.z) / 2;\n  }\n\n  /**\n   * Get obstacle type\n   */\n  getType(): ObstacleType {\n    return this.type;\n  }\n\n  /**\n   * Get obstacle lane\n   */\n  getLane(): number {\n    return this.lane;\n  }\n\n  /**\n   * Poolable interface methods\n   */\n  reset(): void {\n    this.mesh.visible = false;\n    this.lane = 0;\n    this.active = false;\n  }\n\n  isActive(): boolean {\n    return this.active;\n  }\n\n  setActive(active: boolean): void {\n    this.active = active;\n    this.mesh.visible = active;\n  }\n\n  /**\n   * Collidable interface methods\n   */\n  get position(): THREE.Vector3 {\n    return this.mesh.position;\n  }\n\n  getBoundingBox(): THREE.Box3 {\n    return this.boundingBox;\n  }\n\n  getRadius(): number {\n    return this.radius;\n  }\n\n  /**\n   * Dispose of obstacle resources\n   */\n  dispose(): void {\n    this.mesh.traverse(child => {\n      if (child instanceof THREE.Mesh) {\n        child.geometry.dispose();\n        if (Array.isArray(child.material)) {\n          child.material.forEach(mat => mat.dispose());\n        } else {\n          child.material.dispose();\n        }\n      }\n    });\n  }\n}\n","import * as THREE from 'three';\nimport { IPoolable, CollectibleType } from '../types';\nimport { GAME_CONFIG, COLORS } from '../utils/Constants';\nimport { Collidable } from '../systems/CollisionSystem';\n\nexport class Collectible implements IPoolable, Collidable {\n  mesh: THREE.Object3D;\n  private type: CollectibleType;\n  private lane: number = 0;\n  private active: boolean = false;\n  private boundingBox: THREE.Box3;\n  private radius: number = 0.3;\n  private rotationSpeed: number;\n\n  constructor(type: CollectibleType) {\n    this.type = type;\n    this.mesh = this.createCollectibleMesh(type);\n    this.boundingBox = new THREE.Box3();\n    this.mesh.visible = false;\n    this.rotationSpeed = 2 + Math.random() * 2;\n  }\n\n  /**\n   * Create collectible mesh based on type\n   */\n  private createCollectibleMesh(type: CollectibleType): THREE.Object3D {\n    const group = new THREE.Group();\n\n    switch (type) {\n      case CollectibleType.COIN: {\n        const geometry = new THREE.CylinderGeometry(0.3, 0.3, 0.1, 16);\n        const material = new THREE.MeshStandardMaterial({\n          color: COLORS.COIN,\n          emissive: COLORS.COIN,\n          emissiveIntensity: 0.3,\n          metalness: 0.8,\n          roughness: 0.2,\n        });\n        const coin = new THREE.Mesh(geometry, material);\n        coin.rotation.x = Math.PI / 2;\n        group.add(coin);\n        break;\n      }\n\n      case CollectibleType.FISH: {\n        // Simple fish shape\n        const bodyGeometry = new THREE.SphereGeometry(0.4, 8, 8);\n        const material = new THREE.MeshStandardMaterial({\n          color: COLORS.FISH,\n          emissive: COLORS.FISH,\n          emissiveIntensity: 0.3,\n        });\n        const body = new THREE.Mesh(bodyGeometry, material);\n        body.scale.set(1, 0.7, 1.5);\n        group.add(body);\n\n        // Tail\n        const tailGeometry = new THREE.ConeGeometry(0.3, 0.5, 4);\n        const tail = new THREE.Mesh(tailGeometry, material);\n        tail.rotation.z = -Math.PI / 2;\n        tail.position.x = -0.6;\n        group.add(tail);\n        break;\n      }\n\n      case CollectibleType.POWERUP_MAGNET: {\n        const geometry = new THREE.TorusGeometry(0.3, 0.1, 8, 12);\n        const material = new THREE.MeshStandardMaterial({\n          color: COLORS.POWERUP_MAGNET,\n          emissive: COLORS.POWERUP_MAGNET,\n          emissiveIntensity: 0.5,\n        });\n        const magnet = new THREE.Mesh(geometry, material);\n        group.add(magnet);\n\n        // Add glow effect\n        const glowGeometry = new THREE.SphereGeometry(0.5, 16, 16);\n        const glowMaterial = new THREE.MeshBasicMaterial({\n          color: COLORS.POWERUP_MAGNET,\n          transparent: true,\n          opacity: 0.2,\n        });\n        const glow = new THREE.Mesh(glowGeometry, glowMaterial);\n        group.add(glow);\n        break;\n      }\n\n      case CollectibleType.POWERUP_MULTIPLIER: {\n        const geometry = new THREE.BoxGeometry(0.5, 0.5, 0.5);\n        const material = new THREE.MeshStandardMaterial({\n          color: COLORS.POWERUP_MULTIPLIER,\n          emissive: COLORS.POWERUP_MULTIPLIER,\n          emissiveIntensity: 0.5,\n        });\n        const box = new THREE.Mesh(geometry, material);\n        group.add(box);\n\n        // Add glow\n        const glowGeometry = new THREE.SphereGeometry(0.6, 16, 16);\n        const glowMaterial = new THREE.MeshBasicMaterial({\n          color: COLORS.POWERUP_MULTIPLIER,\n          transparent: true,\n          opacity: 0.2,\n        });\n        const glow = new THREE.Mesh(glowGeometry, glowMaterial);\n        group.add(glow);\n        break;\n      }\n\n      case CollectibleType.POWERUP_SHIELD: {\n        const geometry = new THREE.OctahedronGeometry(0.4, 0);\n        const material = new THREE.MeshStandardMaterial({\n          color: COLORS.POWERUP_SHIELD,\n          emissive: COLORS.POWERUP_SHIELD,\n          emissiveIntensity: 0.5,\n        });\n        const shield = new THREE.Mesh(geometry, material);\n        group.add(shield);\n\n        // Add glow\n        const glowGeometry = new THREE.SphereGeometry(0.6, 16, 16);\n        const glowMaterial = new THREE.MeshBasicMaterial({\n          color: COLORS.POWERUP_SHIELD,\n          transparent: true,\n          opacity: 0.2,\n        });\n        const glow = new THREE.Mesh(glowGeometry, glowMaterial);\n        group.add(glow);\n        break;\n      }\n    }\n\n    group.position.y = 1; // Hover height\n    return group;\n  }\n\n  /**\n   * Initialize collectible at a specific position\n   */\n  initialize(lane: number, zPosition: number): void {\n    this.lane = lane;\n    this.mesh.position.x = GAME_CONFIG.LANE_POSITIONS[lane];\n    this.mesh.position.z = zPosition;\n    this.mesh.visible = true;\n    this.setActive(true);\n  }\n\n  /**\n   * Update collectible (rotation and floating animation)\n   */\n  update(deltaTime: number): void {\n    if (!this.active) return;\n\n    // Rotate\n    this.mesh.rotation.y += this.rotationSpeed * deltaTime;\n\n    // Float up and down\n    const floatOffset = Math.sin(Date.now() * 0.003) * 0.2;\n    this.mesh.position.y = 1 + floatOffset;\n\n    this.boundingBox.setFromObject(this.mesh);\n  }\n\n  /**\n   * Get collectible type\n   */\n  getType(): CollectibleType {\n    return this.type;\n  }\n\n  /**\n   * Get collectible lane\n   */\n  getLane(): number {\n    return this.lane;\n  }\n\n  /**\n   * Get value of this collectible\n   */\n  getValue(): number {\n    switch (this.type) {\n      case CollectibleType.COIN:\n        return GAME_CONFIG.COIN_VALUE;\n      case CollectibleType.FISH:\n        return GAME_CONFIG.FISH_VALUE;\n      default:\n        return 0;\n    }\n  }\n\n  /**\n   * Check if this is a power-up\n   */\n  isPowerUp(): boolean {\n    return (\n      this.type === CollectibleType.POWERUP_MAGNET ||\n      this.type === CollectibleType.POWERUP_MULTIPLIER ||\n      this.type === CollectibleType.POWERUP_SHIELD\n    );\n  }\n\n  /**\n   * Poolable interface methods\n   */\n  reset(): void {\n    this.mesh.visible = false;\n    this.mesh.rotation.set(0, 0, 0);\n    this.lane = 0;\n    this.active = false;\n  }\n\n  isActive(): boolean {\n    return this.active;\n  }\n\n  setActive(active: boolean): void {\n    this.active = active;\n    this.mesh.visible = active;\n  }\n\n  /**\n   * Collidable interface methods\n   */\n  get position(): THREE.Vector3 {\n    return this.mesh.position;\n  }\n\n  getBoundingBox(): THREE.Box3 {\n    return this.boundingBox;\n  }\n\n  getRadius(): number {\n    return this.radius;\n  }\n\n  /**\n   * Dispose of collectible resources\n   */\n  dispose(): void {\n    this.mesh.traverse(child => {\n      if (child instanceof THREE.Mesh) {\n        child.geometry.dispose();\n        if (Array.isArray(child.material)) {\n          child.material.forEach(mat => mat.dispose());\n        } else {\n          child.material.dispose();\n        }\n      }\n    });\n  }\n}\n","import { SegmentConfig, ObstacleType, CollectibleType } from '../types';\nimport { GAME_CONFIG } from '../utils/Constants';\n\nexport class LevelGenerator {\n  private segmentCounter: number = 0;\n  private difficulty: number = 0;\n\n  /**\n   * Generate a new level segment\n   */\n  generateSegment(): SegmentConfig {\n    const config: SegmentConfig = {\n      obstacles: [],\n      collectibles: [],\n      difficulty: this.difficulty,\n    };\n\n    // Calculate current difficulty based on segments passed\n    this.difficulty = Math.min(\n      GAME_CONFIG.OBSTACLE_BASE_PROBABILITY +\n        this.segmentCounter * GAME_CONFIG.DIFFICULTY_CURVE_RATE,\n      GAME_CONFIG.OBSTACLE_MAX_PROBABILITY\n    );\n\n    // Generate obstacles\n    this.generateObstacles(config);\n\n    // Generate collectibles (coins, fish)\n    this.generateCollectibles(config);\n\n    // Occasionally add power-ups (less frequent than collectibles)\n    if (Math.random() < 0.15) {\n      this.generatePowerUp(config);\n    }\n\n    this.segmentCounter++;\n    return config;\n  }\n\n  /**\n   * Generate obstacles for a segment\n   */\n  private generateObstacles(config: SegmentConfig): void {\n    const numObstacles = Math.random() < this.difficulty ? this.getObstacleCount() : 0;\n\n    if (numObstacles === 0) {\n      return;\n    }\n\n    const usedPositions: Set<string> = new Set();\n\n    for (let i = 0; i < numObstacles; i++) {\n      const obstacleType = this.randomObstacleType();\n      const lane = this.randomLane();\n      const position = this.randomPositionInSegment();\n\n      // Ensure we don't overlap obstacles at the same position\n      const key = `${lane}-${Math.floor(position)}`;\n      if (usedPositions.has(key)) {\n        continue;\n      }\n      usedPositions.add(key);\n\n      config.obstacles.push({\n        type: obstacleType,\n        lane,\n        position,\n      });\n    }\n\n    // Ensure at least one lane is clear (solvability check)\n    this.ensureSolvable(config);\n  }\n\n  /**\n   * Ensure the segment is solvable (at least one lane is clear)\n   */\n  private ensureSolvable(config: SegmentConfig): void {\n    const lanes = [0, 1, 2];\n    const clearedLanes = lanes.filter(lane => {\n      return !config.obstacles.some(obs => obs.lane === lane);\n    });\n\n    // If no lane is clear, remove obstacles from a random lane\n    if (clearedLanes.length === 0) {\n      const laneToClear = this.randomLane();\n      config.obstacles = config.obstacles.filter(obs => obs.lane !== laneToClear);\n    }\n  }\n\n  /**\n   * Generate collectibles (coins and fish)\n   */\n  private generateCollectibles(config: SegmentConfig): void {\n    // Determine collectible pattern\n    const pattern = Math.random();\n\n    if (pattern < 0.3) {\n      // Single lane of coins\n      this.generateCoinLine(config, this.randomLane());\n    } else if (pattern < 0.5) {\n      // Scattered coins\n      this.generateScatteredCoins(config);\n    } else if (pattern < 0.7) {\n      // Zig-zag pattern\n      this.generateZigZagCoins(config);\n    } else if (pattern < 0.85) {\n      // All lanes with coins\n      this.generateMultiLaneCoins(config);\n    } else {\n      // Special: Fish bonus\n      this.generateFish(config);\n    }\n  }\n\n  /**\n   * Generate a line of coins in a single lane\n   */\n  private generateCoinLine(config: SegmentConfig, lane: number): void {\n    const coinCount = 5 + Math.floor(Math.random() * 5);\n    const spacing = GAME_CONFIG.SEGMENT_LENGTH / (coinCount + 1);\n\n    for (let i = 0; i < coinCount; i++) {\n      const position = spacing * (i + 1);\n      if (!this.isObstacleAt(config, lane, position)) {\n        config.collectibles.push({\n          type: CollectibleType.COIN,\n          lane,\n          position,\n        });\n      }\n    }\n  }\n\n  /**\n   * Generate scattered coins across lanes\n   */\n  private generateScatteredCoins(config: SegmentConfig): void {\n    const coinCount = 3 + Math.floor(Math.random() * 5);\n\n    for (let i = 0; i < coinCount; i++) {\n      const lane = this.randomLane();\n      const position = this.randomPositionInSegment();\n\n      if (!this.isObstacleAt(config, lane, position)) {\n        config.collectibles.push({\n          type: CollectibleType.COIN,\n          lane,\n          position,\n        });\n      }\n    }\n  }\n\n  /**\n   * Generate zig-zag pattern of coins\n   */\n  private generateZigZagCoins(config: SegmentConfig): void {\n    const segments = 3;\n    let currentLane = this.randomLane();\n\n    for (let i = 0; i < segments; i++) {\n      const position = (GAME_CONFIG.SEGMENT_LENGTH / segments) * i + 3;\n      config.collectibles.push({\n        type: CollectibleType.COIN,\n        lane: currentLane,\n        position,\n      });\n\n      // Switch lane\n      currentLane = (currentLane + (Math.random() < 0.5 ? 1 : -1) + 3) % 3;\n    }\n  }\n\n  /**\n   * Generate coins in multiple lanes\n   */\n  private generateMultiLaneCoins(config: SegmentConfig): void {\n    for (let lane = 0; lane < GAME_CONFIG.LANE_COUNT; lane++) {\n      const position = this.randomPositionInSegment();\n      if (!this.isObstacleAt(config, lane, position)) {\n        config.collectibles.push({\n          type: CollectibleType.COIN,\n          lane,\n          position,\n        });\n      }\n    }\n  }\n\n  /**\n   * Generate a fish (high-value collectible)\n   */\n  private generateFish(config: SegmentConfig): void {\n    const lane = this.randomLane();\n    const position = GAME_CONFIG.SEGMENT_LENGTH / 2;\n\n    if (!this.isObstacleAt(config, lane, position)) {\n      config.collectibles.push({\n        type: CollectibleType.FISH,\n        lane,\n        position,\n      });\n    }\n  }\n\n  /**\n   * Generate a power-up\n   */\n  private generatePowerUp(config: SegmentConfig): void {\n    const powerUpTypes = [\n      CollectibleType.POWERUP_MAGNET,\n      CollectibleType.POWERUP_MULTIPLIER,\n      CollectibleType.POWERUP_SHIELD,\n    ];\n\n    const type = powerUpTypes[Math.floor(Math.random() * powerUpTypes.length)];\n    const lane = this.randomLane();\n    const position = this.randomPositionInSegment();\n\n    if (!this.isObstacleAt(config, lane, position)) {\n      config.collectibles.push({\n        type,\n        lane,\n        position,\n      });\n    }\n  }\n\n  /**\n   * Check if there's an obstacle at a specific position\n   */\n  private isObstacleAt(config: SegmentConfig, lane: number, position: number): boolean {\n    return config.obstacles.some(obs => {\n      return obs.lane === lane && Math.abs(obs.position - position) < 2;\n    });\n  }\n\n  /**\n   * Get number of obstacles based on difficulty\n   */\n  private getObstacleCount(): number {\n    const rand = Math.random();\n    if (this.difficulty < 0.3) {\n      return 1;\n    } else if (this.difficulty < 0.5) {\n      return rand < 0.7 ? 1 : 2;\n    } else {\n      return rand < 0.5 ? 2 : 3;\n    }\n  }\n\n  /**\n   * Get a random obstacle type\n   */\n  private randomObstacleType(): ObstacleType {\n    const types = [ObstacleType.LOW, ObstacleType.MIDDLE, ObstacleType.HIGH];\n    return types[Math.floor(Math.random() * types.length)];\n  }\n\n  /**\n   * Get a random lane index\n   */\n  private randomLane(): number {\n    return Math.floor(Math.random() * GAME_CONFIG.LANE_COUNT);\n  }\n\n  /**\n   * Get a random position within a segment\n   */\n  private randomPositionInSegment(): number {\n    return 3 + Math.random() * (GAME_CONFIG.SEGMENT_LENGTH - 6);\n  }\n\n  /**\n   * Reset the generator\n   */\n  reset(): void {\n    this.segmentCounter = 0;\n    this.difficulty = 0;\n  }\n\n  /**\n   * Get current difficulty\n   */\n  getDifficulty(): number {\n    return this.difficulty;\n  }\n\n  /**\n   * Get segment counter\n   */\n  getSegmentCount(): number {\n    return this.segmentCounter;\n  }\n}\n","import * as THREE from 'three';\n\nexport interface Collidable {\n  position: THREE.Vector3;\n  getBoundingBox(): THREE.Box3;\n  getRadius(): number;\n}\n\nexport class CollisionSystem {\n  /**\n   * Check AABB (Axis-Aligned Bounding Box) collision\n   */\n  static checkAABBCollision(obj1: Collidable, obj2: Collidable): boolean {\n    const box1 = obj1.getBoundingBox();\n    const box2 = obj2.getBoundingBox();\n    return box1.intersectsBox(box2);\n  }\n\n  /**\n   * Check sphere collision (faster than AABB)\n   */\n  static checkSphereCollision(obj1: Collidable, obj2: Collidable): boolean {\n    const distance = obj1.position.distanceTo(obj2.position);\n    const combinedRadius = obj1.getRadius() + obj2.getRadius();\n    return distance < combinedRadius;\n  }\n\n  /**\n   * Check if two objects are in the same lane and close enough on Z-axis\n   */\n  static checkLaneCollision(\n    obj1Lane: number,\n    obj1Z: number,\n    obj2Lane: number,\n    obj2Z: number,\n    threshold: number = 1.5\n  ): boolean {\n    if (obj1Lane !== obj2Lane) {\n      return false;\n    }\n    return Math.abs(obj1Z - obj2Z) < threshold;\n  }\n\n  /**\n   * Get all objects within a certain range\n   */\n  static getObjectsInRange<T extends Collidable>(\n    origin: THREE.Vector3,\n    objects: T[],\n    range: number\n  ): T[] {\n    return objects.filter(obj => {\n      const distance = origin.distanceTo(obj.position);\n      return distance <= range;\n    });\n  }\n\n  /**\n   * Check ray intersection for line-of-sight or projectile collision\n   */\n  static raycast(\n    origin: THREE.Vector3,\n    direction: THREE.Vector3,\n    objects: THREE.Object3D[],\n    maxDistance: number = Infinity\n  ): THREE.Intersection[] {\n    const raycaster = new THREE.Raycaster(origin, direction.normalize(), 0, maxDistance);\n    return raycaster.intersectObjects(objects, true);\n  }\n\n  /**\n   * Create a bounding box from a mesh\n   */\n  static createBoundingBox(mesh: THREE.Object3D): THREE.Box3 {\n    const box = new THREE.Box3();\n    box.setFromObject(mesh);\n    return box;\n  }\n\n  /**\n   * Calculate radius from bounding box\n   */\n  static calculateRadius(mesh: THREE.Object3D): number {\n    const box = this.createBoundingBox(mesh);\n    const size = new THREE.Vector3();\n    box.getSize(size);\n    return Math.max(size.x, size.y, size.z) / 2;\n  }\n}\n","import { IPoolable } from '../types';\n\n/**\n * Generic Object Pool for reusing game objects\n * Reduces garbage collection by recycling objects\n */\nexport class ObjectPool<T extends IPoolable> {\n  private pool: T[] = [];\n  private active: Set<T> = new Set();\n  private factory: () => T;\n  private maxSize: number;\n\n  constructor(factory: () => T, initialSize: number = 10, maxSize: number = 50) {\n    this.factory = factory;\n    this.maxSize = maxSize;\n\n    // Pre-populate pool\n    for (let i = 0; i < initialSize; i++) {\n      const obj = this.factory();\n      obj.setActive(false);\n      this.pool.push(obj);\n    }\n  }\n\n  /**\n   * Get an object from the pool or create a new one\n   */\n  acquire(): T {\n    let obj: T;\n\n    if (this.pool.length > 0) {\n      obj = this.pool.pop()!;\n    } else {\n      obj = this.factory();\n    }\n\n    obj.reset();\n    obj.setActive(true);\n    this.active.add(obj);\n    return obj;\n  }\n\n  /**\n   * Return an object to the pool\n   */\n  release(obj: T): void {\n    if (!this.active.has(obj)) {\n      return;\n    }\n\n    obj.setActive(false);\n    this.active.delete(obj);\n\n    // Only keep objects if pool isn't full\n    if (this.pool.length < this.maxSize) {\n      this.pool.push(obj);\n    } else {\n      obj.dispose();\n    }\n  }\n\n  /**\n   * Release all active objects\n   */\n  releaseAll(): void {\n    const activeArray = Array.from(this.active);\n    activeArray.forEach(obj => this.release(obj));\n  }\n\n  /**\n   * Update all active objects\n   */\n  updateActive(deltaTime: number): void {\n    this.active.forEach(obj => {\n      if (obj.isActive()) {\n        obj.update(deltaTime);\n      }\n    });\n  }\n\n  /**\n   * Get all active objects\n   */\n  getActive(): T[] {\n    return Array.from(this.active);\n  }\n\n  /**\n   * Get pool statistics\n   */\n  getStats() {\n    return {\n      pooled: this.pool.length,\n      active: this.active.size,\n      total: this.pool.length + this.active.size,\n    };\n  }\n\n  /**\n   * Clear and dispose all objects\n   */\n  dispose(): void {\n    this.releaseAll();\n    this.pool.forEach(obj => obj.dispose());\n    this.pool = [];\n    this.active.clear();\n  }\n}\n","import * as THREE from 'three';\nimport { Player } from '../entities/Player';\nimport { Obstacle } from '../entities/Obstacle';\nimport { Collectible } from '../entities/Collectible';\nimport { LevelGenerator } from '../systems/LevelGenerator';\nimport { CollisionSystem } from '../systems/CollisionSystem';\nimport { ObjectPool } from '../utils/ObjectPool';\nimport { GAME_CONFIG, COLORS, ObstacleType, CollectibleType } from '../utils/Constants';\nimport { SegmentConfig } from '../types';\n\nexport class GameScene {\n  scene: THREE.Scene;\n  camera: THREE.PerspectiveCamera;\n  renderer: THREE.WebGLRenderer;\n\n  private player: Player;\n  private levelGenerator: LevelGenerator;\n\n  // Object pools\n  private obstaclePoolsMap: Map<ObstacleType, ObjectPool<Obstacle>> = new Map();\n  private collectiblePoolsMap: Map<CollectibleType, ObjectPool<Collectible>> = new Map();\n\n  // World scrolling\n  private worldGroup: THREE.Group;\n  private segments: THREE.Group[] = [];\n  private currentSpeed: number = GAME_CONFIG.BASE_SPEED;\n  private distanceTraveled: number = 0;\n\n  // Callbacks\n  private onCollision?: (type: 'obstacle' | 'collectible', object: any) => void;\n\n  constructor(container: HTMLElement) {\n    // Create scene\n    this.scene = new THREE.Scene();\n    this.scene.background = new THREE.Color(COLORS.SKY_TOP);\n    this.scene.fog = new THREE.Fog(COLORS.SKY_BOTTOM, 50, 100);\n\n    // Create camera\n    this.camera = new THREE.PerspectiveCamera(\n      GAME_CONFIG.CAMERA_FOV,\n      window.innerWidth / window.innerHeight,\n      GAME_CONFIG.CAMERA_NEAR,\n      GAME_CONFIG.CAMERA_FAR\n    );\n\n    // Create renderer\n    this.renderer = new THREE.WebGLRenderer({ antialias: true });\n    this.renderer.setSize(window.innerWidth, window.innerHeight);\n    this.renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));\n    this.renderer.shadowMap.enabled = GAME_CONFIG.ENABLE_SHADOWS;\n    this.renderer.shadowMap.type = THREE.PCFSoftShadowMap;\n    container.appendChild(this.renderer.domElement);\n\n    // Setup lights\n    this.setupLights();\n\n    // Create world group (for scrolling)\n    this.worldGroup = new THREE.Group();\n    this.scene.add(this.worldGroup);\n\n    // Create player\n    this.player = new Player(this.scene);\n\n    // Position camera\n    this.updateCamera();\n\n    // Initialize level generator\n    this.levelGenerator = new LevelGenerator();\n\n    // Initialize object pools\n    this.initializeObjectPools();\n\n    // Generate initial segments\n    this.generateInitialSegments();\n\n    // Handle window resize\n    window.addEventListener('resize', this.onWindowResize.bind(this));\n  }\n\n  private setupLights(): void {\n    // Hemisphere light for ambient lighting\n    const hemiLight = new THREE.HemisphereLight(COLORS.SKY_TOP, COLORS.GROUND, 0.6);\n    this.scene.add(hemiLight);\n\n    // Directional light for shadows\n    const dirLight = new THREE.DirectionalLight(0xffffff, 0.8);\n    dirLight.position.set(5, 10, 5);\n    dirLight.castShadow = GAME_CONFIG.ENABLE_SHADOWS;\n\n    if (GAME_CONFIG.ENABLE_SHADOWS) {\n      dirLight.shadow.camera.left = -20;\n      dirLight.shadow.camera.right = 20;\n      dirLight.shadow.camera.top = 20;\n      dirLight.shadow.camera.bottom = -20;\n      dirLight.shadow.mapSize.width = GAME_CONFIG.SHADOW_MAP_SIZE;\n      dirLight.shadow.mapSize.height = GAME_CONFIG.SHADOW_MAP_SIZE;\n    }\n\n    this.scene.add(dirLight);\n  }\n\n  private initializeObjectPools(): void {\n    // Initialize obstacle pools\n    Object.values(ObstacleType).forEach(type => {\n      const pool = new ObjectPool<Obstacle>(\n        () => {\n          const obstacle = new Obstacle(type);\n          this.worldGroup.add(obstacle.mesh);\n          return obstacle;\n        },\n        5,\n        GAME_CONFIG.MAX_POOL_SIZE\n      );\n      this.obstaclePoolsMap.set(type, pool);\n    });\n\n    // Initialize collectible pools\n    Object.values(CollectibleType).forEach(type => {\n      const pool = new ObjectPool<Collectible>(\n        () => {\n          const collectible = new Collectible(type);\n          this.worldGroup.add(collectible.mesh);\n          return collectible;\n        },\n        5,\n        GAME_CONFIG.MAX_POOL_SIZE\n      );\n      this.collectiblePoolsMap.set(type, pool);\n    });\n  }\n\n  private generateInitialSegments(): void {\n    for (let i = 0; i < GAME_CONFIG.INITIAL_SEGMENTS; i++) {\n      this.generateSegment(i * GAME_CONFIG.SEGMENT_LENGTH);\n    }\n  }\n\n  private generateSegment(zPosition: number): void {\n    const segment = new THREE.Group();\n    segment.position.z = zPosition;\n\n    // Create ground for this segment\n    const groundGeometry = new THREE.PlaneGeometry(\n      GAME_CONFIG.LANE_WIDTH * GAME_CONFIG.LANE_COUNT + 2,\n      GAME_CONFIG.SEGMENT_LENGTH\n    );\n    const groundMaterial = new THREE.MeshStandardMaterial({\n      color: COLORS.GROUND,\n      roughness: 0.8,\n    });\n    const ground = new THREE.Mesh(groundGeometry, groundMaterial);\n    ground.rotation.x = -Math.PI / 2;\n    ground.position.z = GAME_CONFIG.SEGMENT_LENGTH / 2;\n    ground.receiveShadow = GAME_CONFIG.ENABLE_SHADOWS;\n    segment.add(ground);\n\n    // Add lane markers\n    for (let i = 0; i <= GAME_CONFIG.LANE_COUNT; i++) {\n      const lineGeometry = new THREE.BoxGeometry(0.1, 0.1, GAME_CONFIG.SEGMENT_LENGTH);\n      const lineMaterial = new THREE.MeshBasicMaterial({ color: 0xffffff, transparent: true, opacity: 0.3 });\n      const line = new THREE.Mesh(lineGeometry, lineMaterial);\n      line.position.x = -GAME_CONFIG.LANE_WIDTH * GAME_CONFIG.LANE_COUNT / 2 + i * GAME_CONFIG.LANE_WIDTH;\n      line.position.z = GAME_CONFIG.SEGMENT_LENGTH / 2;\n      segment.add(line);\n    }\n\n    // Generate segment content\n    const config = this.levelGenerator.generateSegment();\n    this.populateSegment(segment, config);\n\n    this.worldGroup.add(segment);\n    this.segments.push(segment);\n  }\n\n  private populateSegment(segment: THREE.Group, config: SegmentConfig): void {\n    const baseZ = segment.position.z;\n\n    // Add obstacles\n    config.obstacles.forEach(obstacleConfig => {\n      const pool = this.obstaclePoolsMap.get(obstacleConfig.type);\n      if (pool) {\n        const obstacle = pool.acquire();\n        obstacle.initialize(obstacleConfig.lane, baseZ + obstacleConfig.position);\n      }\n    });\n\n    // Add collectibles\n    config.collectibles.forEach(collectibleConfig => {\n      const pool = this.collectiblePoolsMap.get(collectibleConfig.type);\n      if (pool) {\n        const collectible = pool.acquire();\n        collectible.initialize(collectibleConfig.lane, baseZ + collectibleConfig.position);\n      }\n    });\n  }\n\n  /**\n   * Update game scene\n   */\n  update(deltaTime: number): void {\n    // Update player\n    this.player.update(deltaTime);\n\n    // Update world scrolling\n    this.updateWorldScroll(deltaTime);\n\n    // Update all pooled objects\n    this.obstaclePoolsMap.forEach(pool => pool.updateActive(deltaTime));\n    this.collectiblePoolsMap.forEach(pool => pool.updateActive(deltaTime));\n\n    // Check collisions\n    this.checkCollisions();\n\n    // Update camera\n    this.updateCamera();\n  }\n\n  private updateWorldScroll(deltaTime: number): void {\n    // Move world backward (player moves forward)\n    const scrollAmount = this.currentSpeed * deltaTime;\n    this.worldGroup.position.z -= scrollAmount;\n    this.distanceTraveled += scrollAmount;\n\n    // Check if we need to generate new segments\n    const playerZ = this.player.position.z - this.worldGroup.position.z;\n    const farthestSegmentZ = this.segments[this.segments.length - 1]?.position.z || 0;\n\n    if (farthestSegmentZ - playerZ < GAME_CONFIG.SEGMENTS_AHEAD * GAME_CONFIG.SEGMENT_LENGTH) {\n      this.generateSegment(farthestSegmentZ + GAME_CONFIG.SEGMENT_LENGTH);\n    }\n\n    // Remove old segments that are behind the player\n    while (this.segments.length > 0) {\n      const oldestSegment = this.segments[0];\n      if (oldestSegment.position.z < playerZ - GAME_CONFIG.SEGMENT_LENGTH * 2) {\n        this.worldGroup.remove(oldestSegment);\n        this.segments.shift();\n\n        // Dispose segment\n        oldestSegment.traverse(child => {\n          if (child instanceof THREE.Mesh) {\n            child.geometry.dispose();\n            if (Array.isArray(child.material)) {\n              child.material.forEach(mat => mat.dispose());\n            } else {\n              child.material.dispose();\n            }\n          }\n        });\n      } else {\n        break;\n      }\n    }\n\n    // Release pooled objects that are too far behind\n    this.releaseOldPooledObjects(playerZ);\n  }\n\n  private releaseOldPooledObjects(playerZ: number): void {\n    this.obstaclePoolsMap.forEach(pool => {\n      pool.getActive().forEach(obstacle => {\n        if (obstacle.position.z < playerZ - GAME_CONFIG.SEGMENT_LENGTH) {\n          pool.release(obstacle);\n        }\n      });\n    });\n\n    this.collectiblePoolsMap.forEach(pool => {\n      pool.getActive().forEach(collectible => {\n        if (collectible.position.z < playerZ - GAME_CONFIG.SEGMENT_LENGTH) {\n          pool.release(collectible);\n        }\n      });\n    });\n  }\n\n  private checkCollisions(): void {\n    const playerLane = this.player.getLane();\n    const playerZ = this.player.position.z;\n\n    // Check obstacle collisions\n    this.obstaclePoolsMap.forEach(pool => {\n      pool.getActive().forEach(obstacle => {\n        // Convert obstacle's local position to world position\n        const obstacleWorldZ = obstacle.position.z + this.worldGroup.position.z;\n\n        if (CollisionSystem.checkLaneCollision(playerLane, playerZ, obstacle.getLane(), obstacleWorldZ)) {\n          // Create a temporary position for sphere collision check\n          const obstacleWorldPos = new THREE.Vector3(\n            obstacle.position.x,\n            obstacle.position.y,\n            obstacleWorldZ\n          );\n\n          // Check sphere collision using world coordinates\n          const distance = this.player.position.distanceTo(obstacleWorldPos);\n          const combinedRadius = this.player.getRadius() + obstacle.getRadius();\n\n          if (distance < combinedRadius) {\n            console.log('Obstacle collision detected!', {\n              playerLane,\n              playerZ,\n              obstacleLane: obstacle.getLane(),\n              obstacleWorldZ,\n              distance,\n              combinedRadius,\n              invincible: this.player.isInvincible()\n            });\n            this.onCollision?.('obstacle', obstacle);\n            pool.release(obstacle);\n          }\n        }\n      });\n    });\n\n    // Check collectible collisions\n    this.collectiblePoolsMap.forEach(pool => {\n      pool.getActive().forEach(collectible => {\n        // Convert collectible's local position to world position\n        const collectibleWorldZ = collectible.position.z + this.worldGroup.position.z;\n\n        if (CollisionSystem.checkLaneCollision(playerLane, playerZ, collectible.getLane(), collectibleWorldZ, 2)) {\n          // Create a temporary position for sphere collision check\n          const collectibleWorldPos = new THREE.Vector3(\n            collectible.position.x,\n            collectible.position.y,\n            collectibleWorldZ\n          );\n\n          // Check sphere collision using world coordinates\n          const distance = this.player.position.distanceTo(collectibleWorldPos);\n          const combinedRadius = this.player.getRadius() + collectible.getRadius();\n\n          if (distance < combinedRadius) {\n            this.onCollision?.('collectible', collectible);\n            pool.release(collectible);\n          }\n        }\n      });\n    });\n  }\n\n  private updateCamera(): void {\n    // Follow player with offset\n    this.camera.position.x = this.player.position.x;\n    this.camera.position.y = this.player.position.y + GAME_CONFIG.CAMERA_OFFSET_Y;\n    this.camera.position.z = this.player.position.z + GAME_CONFIG.CAMERA_OFFSET_Z;\n\n    // Look ahead of player\n    this.camera.lookAt(\n      this.player.position.x,\n      this.player.position.y + 1,\n      this.player.position.z + GAME_CONFIG.CAMERA_LOOK_AHEAD\n    );\n  }\n\n  private onWindowResize(): void {\n    this.camera.aspect = window.innerWidth / window.innerHeight;\n    this.camera.updateProjectionMatrix();\n    this.renderer.setSize(window.innerWidth, window.innerHeight);\n  }\n\n  /**\n   * Set game speed\n   */\n  setSpeed(speed: number): void {\n    this.currentSpeed = speed;\n  }\n\n  /**\n   * Get player\n   */\n  getPlayer(): Player {\n    return this.player;\n  }\n\n  /**\n   * Set collision callback\n   */\n  setCollisionCallback(callback: (type: 'obstacle' | 'collectible', object: any) => void): void {\n    this.onCollision = callback;\n  }\n\n  /**\n   * Render scene\n   */\n  render(): void {\n    this.renderer.render(this.scene, this.camera);\n  }\n\n  /**\n   * Reset scene\n   */\n  reset(): void {\n    // Reset player\n    this.player.reset();\n\n    // Clear all pooled objects\n    this.obstaclePoolsMap.forEach(pool => pool.releaseAll());\n    this.collectiblePoolsMap.forEach(pool => pool.releaseAll());\n\n    // Remove all segments\n    this.segments.forEach(segment => {\n      this.worldGroup.remove(segment);\n    });\n    this.segments = [];\n\n    // Reset world position\n    this.worldGroup.position.set(0, 0, 0);\n    this.distanceTraveled = 0;\n\n    // Reset level generator\n    this.levelGenerator.reset();\n\n    // Generate initial segments\n    this.generateInitialSegments();\n\n    // Reset speed\n    this.currentSpeed = GAME_CONFIG.BASE_SPEED;\n  }\n\n  /**\n   * Dispose of scene resources\n   */\n  dispose(): void {\n    window.removeEventListener('resize', this.onWindowResize.bind(this));\n\n    this.player.dispose();\n    this.obstaclePoolsMap.forEach(pool => pool.dispose());\n    this.collectiblePoolsMap.forEach(pool => pool.dispose());\n\n    this.scene.traverse(object => {\n      if (object instanceof THREE.Mesh) {\n        object.geometry.dispose();\n        if (Array.isArray(object.material)) {\n          object.material.forEach(mat => mat.dispose());\n        } else {\n          object.material.dispose();\n        }\n      }\n    });\n\n    this.renderer.dispose();\n  }\n}\n","import { InputState, TouchState } from '../types';\n\nexport class InputManager {\n  private inputState: InputState = {\n    left: false,\n    right: false,\n    jump: false,\n    slide: false,\n    pause: false,\n  };\n\n  private touchState: TouchState = {\n    startX: 0,\n    startY: 0,\n    endX: 0,\n    endY: 0,\n    startTime: 0,\n    isSwiping: false,\n  };\n\n  private readonly SWIPE_THRESHOLD = 50; // Minimum distance for a swipe\n  private readonly SWIPE_MAX_TIME = 500; // Maximum time for a swipe (ms)\n\n  private keydownHandler: (e: KeyboardEvent) => void;\n  private keyupHandler: (e: KeyboardEvent) => void;\n  private touchstartHandler: (e: TouchEvent) => void;\n  private touchmoveHandler: (e: TouchEvent) => void;\n  private touchendHandler: (e: TouchEvent) => void;\n\n  private isGamePlaying: boolean = false;\n\n  constructor() {\n    this.keydownHandler = this.onKeyDown.bind(this);\n    this.keyupHandler = this.onKeyUp.bind(this);\n    this.touchstartHandler = this.onTouchStart.bind(this);\n    this.touchmoveHandler = this.onTouchMove.bind(this);\n    this.touchendHandler = this.onTouchEnd.bind(this);\n\n    this.setupEventListeners();\n  }\n\n  private setupEventListeners(): void {\n    // Keyboard events\n    window.addEventListener('keydown', this.keydownHandler);\n    window.addEventListener('keyup', this.keyupHandler);\n\n    // Touch events\n    window.addEventListener('touchstart', this.touchstartHandler, { passive: false });\n    window.addEventListener('touchmove', this.touchmoveHandler, { passive: false });\n    window.addEventListener('touchend', this.touchendHandler, { passive: false });\n  }\n\n  private onKeyDown(e: KeyboardEvent): void {\n    switch (e.code) {\n      case 'ArrowLeft':\n      case 'KeyA':\n        this.inputState.left = true;\n        e.preventDefault();\n        break;\n      case 'ArrowRight':\n      case 'KeyD':\n        this.inputState.right = true;\n        e.preventDefault();\n        break;\n      case 'Space':\n      case 'ArrowUp':\n      case 'KeyW':\n        this.inputState.jump = true;\n        e.preventDefault();\n        break;\n      case 'ShiftLeft':\n      case 'ShiftRight':\n      case 'ArrowDown':\n      case 'KeyS':\n        this.inputState.slide = true;\n        e.preventDefault();\n        break;\n      case 'Escape':\n      case 'KeyP':\n        this.inputState.pause = true;\n        e.preventDefault();\n        break;\n    }\n  }\n\n  private onKeyUp(e: KeyboardEvent): void {\n    switch (e.code) {\n      case 'ArrowLeft':\n      case 'KeyA':\n        this.inputState.left = false;\n        break;\n      case 'ArrowRight':\n      case 'KeyD':\n        this.inputState.right = false;\n        break;\n      case 'Space':\n      case 'ArrowUp':\n      case 'KeyW':\n        this.inputState.jump = false;\n        break;\n      case 'ShiftLeft':\n      case 'ShiftRight':\n      case 'ArrowDown':\n      case 'KeyS':\n        this.inputState.slide = false;\n        break;\n      case 'Escape':\n      case 'KeyP':\n        this.inputState.pause = false;\n        break;\n    }\n  }\n\n  private onTouchStart(e: TouchEvent): void {\n    // Only handle touch events when game is playing\n    if (!this.isGamePlaying) return;\n\n    e.preventDefault();\n    const touch = e.touches[0];\n    this.touchState.startX = touch.clientX;\n    this.touchState.startY = touch.clientY;\n    this.touchState.startTime = Date.now();\n    this.touchState.isSwiping = true;\n  }\n\n  private onTouchMove(e: TouchEvent): void {\n    // Only handle touch events when game is playing\n    if (!this.isGamePlaying) return;\n\n    e.preventDefault();\n    if (!this.touchState.isSwiping) return;\n\n    const touch = e.touches[0];\n    this.touchState.endX = touch.clientX;\n    this.touchState.endY = touch.clientY;\n  }\n\n  private onTouchEnd(e: TouchEvent): void {\n    // Only handle touch events when game is playing\n    if (!this.isGamePlaying) return;\n\n    e.preventDefault();\n    if (!this.touchState.isSwiping) return;\n\n    const deltaX = this.touchState.endX - this.touchState.startX;\n    const deltaY = this.touchState.endY - this.touchState.startY;\n    const deltaTime = Date.now() - this.touchState.startTime;\n\n    // Check if it's a valid swipe\n    if (deltaTime < this.SWIPE_MAX_TIME) {\n      const absDeltaX = Math.abs(deltaX);\n      const absDeltaY = Math.abs(deltaY);\n\n      if (absDeltaX > this.SWIPE_THRESHOLD || absDeltaY > this.SWIPE_THRESHOLD) {\n        if (absDeltaX > absDeltaY) {\n          // Horizontal swipe\n          if (deltaX > 0) {\n            this.triggerAction('right');\n          } else {\n            this.triggerAction('left');\n          }\n        } else {\n          // Vertical swipe\n          if (deltaY < 0) {\n            this.triggerAction('jump');\n          } else {\n            this.triggerAction('slide');\n          }\n        }\n      }\n    }\n\n    this.touchState.isSwiping = false;\n  }\n\n  private triggerAction(action: 'left' | 'right' | 'jump' | 'slide'): void {\n    this.inputState[action] = true;\n    // Auto-reset after a short delay to simulate button press\n    setTimeout(() => {\n      this.inputState[action] = false;\n    }, 100);\n  }\n\n  /**\n   * Get current input state\n   */\n  getInputState(): Readonly<InputState> {\n    return this.inputState;\n  }\n\n  /**\n   * Check if a specific input is active\n   */\n  isInputActive(input: keyof InputState): boolean {\n    return this.inputState[input];\n  }\n\n  /**\n   * Reset all input states\n   */\n  reset(): void {\n    this.inputState = {\n      left: false,\n      right: false,\n      jump: false,\n      slide: false,\n      pause: false,\n    };\n  }\n\n  /**\n   * Set whether the game is currently playing\n   * This controls whether touch events should be intercepted\n   */\n  setGamePlaying(isPlaying: boolean): void {\n    this.isGamePlaying = isPlaying;\n  }\n\n  /**\n   * Clean up event listeners\n   */\n  dispose(): void {\n    window.removeEventListener('keydown', this.keydownHandler);\n    window.removeEventListener('keyup', this.keyupHandler);\n    window.removeEventListener('touchstart', this.touchstartHandler);\n    window.removeEventListener('touchmove', this.touchmoveHandler);\n    window.removeEventListener('touchend', this.touchendHandler);\n  }\n}\n","import { GameStats } from '../types';\nimport { GAME_CONFIG } from '../utils/Constants';\n\nexport class ScoreSystem {\n  private stats: GameStats = {\n    score: 0,\n    distance: 0,\n    coins: 0,\n    totalCoins: 0,\n    multiplier: 1,\n    combo: 0,\n    speed: GAME_CONFIG.BASE_SPEED,\n    segmentsPassed: 0,\n  };\n\n  private comboTimer: number = 0;\n  private listeners: Map<string, Function[]> = new Map();\n\n  constructor() {\n    this.reset();\n  }\n\n  /**\n   * Update distance and calculate score\n   */\n  update(deltaTime: number): void {\n    // Update distance (speed * time)\n    const distanceGained = (this.stats.speed * deltaTime) / 10; // Convert to meters\n    this.stats.distance += distanceGained;\n\n    // Add distance-based score\n    this.stats.score += Math.floor(distanceGained * GAME_CONFIG.SCORE_PER_METER * this.stats.multiplier);\n\n    // Update combo timer\n    if (this.stats.combo > 0) {\n      this.comboTimer -= deltaTime * 1000;\n      if (this.comboTimer <= 0) {\n        this.resetCombo();\n      }\n    }\n\n    this.emit('distanceChange', Math.floor(this.stats.distance));\n    this.emit('scoreChange', this.stats.score);\n  }\n\n  /**\n   * Add score from collecting items or performing actions\n   */\n  addScore(points: number): void {\n    const finalPoints = Math.floor(points * this.stats.multiplier);\n    this.stats.score += finalPoints;\n    this.emit('scoreChange', this.stats.score);\n  }\n\n  /**\n   * Collect a coin\n   */\n  collectCoin(value: number = GAME_CONFIG.COIN_VALUE): void {\n    this.stats.coins++;\n    this.stats.totalCoins++;\n    this.addScore(value);\n    this.incrementCombo();\n    this.emit('coinCollect', this.stats.coins);\n  }\n\n  /**\n   * Collect a fish (high-value collectible)\n   */\n  collectFish(value: number = GAME_CONFIG.FISH_VALUE): void {\n    this.stats.coins += 5; // Fish counts as 5 coins\n    this.stats.totalCoins += 5;\n    this.addScore(value);\n    this.incrementCombo();\n    this.emit('coinCollect', this.stats.coins);\n  }\n\n  /**\n   * Increment combo counter\n   */\n  private incrementCombo(): void {\n    this.stats.combo++;\n    this.comboTimer = GAME_CONFIG.COMBO_TIMEOUT;\n\n    // Bonus score for combos\n    if (this.stats.combo > 5) {\n      const comboBonus = Math.floor(this.stats.combo / 5) * 10;\n      this.addScore(comboBonus);\n    }\n  }\n\n  /**\n   * Reset combo counter\n   */\n  private resetCombo(): void {\n    this.stats.combo = 0;\n    this.comboTimer = 0;\n  }\n\n  /**\n   * Set score multiplier (from power-ups)\n   */\n  setMultiplier(multiplier: number): void {\n    this.stats.multiplier = multiplier;\n  }\n\n  /**\n   * Set current game speed\n   */\n  setSpeed(speed: number): void {\n    this.stats.speed = speed;\n  }\n\n  /**\n   * Increment segments passed counter\n   */\n  incrementSegments(): void {\n    this.stats.segmentsPassed++;\n  }\n\n  /**\n   * Get current game statistics\n   */\n  getStats(): Readonly<GameStats> {\n    return { ...this.stats };\n  }\n\n  /**\n   * Get specific stat value\n   */\n  getStat(key: keyof GameStats): number {\n    return this.stats[key];\n  }\n\n  /**\n   * Reset all statistics\n   */\n  reset(): void {\n    const totalCoins = this.stats.totalCoins; // Preserve total coins across games\n    this.stats = {\n      score: 0,\n      distance: 0,\n      coins: 0,\n      totalCoins: totalCoins,\n      multiplier: 1,\n      combo: 0,\n      speed: GAME_CONFIG.BASE_SPEED,\n      segmentsPassed: 0,\n    };\n    this.comboTimer = 0;\n  }\n\n  /**\n   * Event system for score changes\n   */\n  on(event: string, callback: Function): void {\n    if (!this.listeners.has(event)) {\n      this.listeners.set(event, []);\n    }\n    this.listeners.get(event)!.push(callback);\n  }\n\n  private emit(event: string, ...args: any[]): void {\n    const callbacks = this.listeners.get(event);\n    if (callbacks) {\n      callbacks.forEach(cb => cb(...args));\n    }\n  }\n\n  /**\n   * Save high score to localStorage\n   */\n  saveHighScore(): number {\n    const currentHigh = this.getHighScore();\n    if (this.stats.score > currentHigh) {\n      localStorage.setItem('cat-runrun-highscore', this.stats.score.toString());\n      return this.stats.score;\n    }\n    return currentHigh;\n  }\n\n  /**\n   * Get high score from localStorage\n   */\n  getHighScore(): number {\n    const stored = localStorage.getItem('cat-runrun-highscore');\n    return stored ? parseInt(stored, 10) : 0;\n  }\n\n  /**\n   * Save total coins to localStorage\n   */\n  saveTotalCoins(): void {\n    localStorage.setItem('cat-runrun-totalcoins', this.stats.totalCoins.toString());\n  }\n\n  /**\n   * Load total coins from localStorage\n   */\n  loadTotalCoins(): void {\n    const stored = localStorage.getItem('cat-runrun-totalcoins');\n    this.stats.totalCoins = stored ? parseInt(stored, 10) : 0;\n  }\n}\n","import { PowerUp, PowerUpType } from '../types';\nimport { GAME_CONFIG } from '../utils/Constants';\n\nexport class PowerUpSystem {\n  private powerUps: Map<PowerUpType, PowerUp> = new Map();\n  private listeners: Map<string, Function[]> = new Map();\n\n  constructor() {\n    this.initializePowerUps();\n  }\n\n  private initializePowerUps(): void {\n    // Initialize all power-up types\n    this.powerUps.set(PowerUpType.MAGNET, {\n      type: PowerUpType.MAGNET,\n      duration: GAME_CONFIG.MAGNET_DURATION,\n      remainingTime: 0,\n      active: false,\n    });\n\n    this.powerUps.set(PowerUpType.MULTIPLIER, {\n      type: PowerUpType.MULTIPLIER,\n      duration: GAME_CONFIG.MULTIPLIER_DURATION,\n      remainingTime: 0,\n      active: false,\n    });\n\n    this.powerUps.set(PowerUpType.SHIELD, {\n      type: PowerUpType.SHIELD,\n      duration: GAME_CONFIG.SHIELD_DURATION,\n      remainingTime: 0,\n      active: false,\n    });\n  }\n\n  /**\n   * Update all active power-ups\n   */\n  update(deltaTime: number): void {\n    this.powerUps.forEach((powerUp, type) => {\n      if (powerUp.active) {\n        powerUp.remainingTime -= deltaTime;\n\n        if (powerUp.remainingTime <= 0) {\n          this.deactivatePowerUp(type);\n        } else {\n          this.emit('powerUpUpdate', type, powerUp.remainingTime);\n        }\n      }\n    });\n  }\n\n  /**\n   * Activate a power-up\n   */\n  activatePowerUp(type: PowerUpType): void {\n    const powerUp = this.powerUps.get(type);\n    if (!powerUp) return;\n\n    // If already active, extend the duration\n    if (powerUp.active) {\n      powerUp.remainingTime = Math.min(\n        powerUp.remainingTime + powerUp.duration,\n        powerUp.duration * 2 // Cap at 2x duration\n      );\n    } else {\n      powerUp.active = true;\n      powerUp.remainingTime = powerUp.duration;\n      this.emit('powerUpActivate', type);\n    }\n  }\n\n  /**\n   * Deactivate a power-up\n   */\n  private deactivatePowerUp(type: PowerUpType): void {\n    const powerUp = this.powerUps.get(type);\n    if (!powerUp) return;\n\n    powerUp.active = false;\n    powerUp.remainingTime = 0;\n    this.emit('powerUpExpire', type);\n  }\n\n  /**\n   * Check if a specific power-up is active\n   */\n  isActive(type: PowerUpType): boolean {\n    const powerUp = this.powerUps.get(type);\n    return powerUp ? powerUp.active : false;\n  }\n\n  /**\n   * Get remaining time for a power-up\n   */\n  getRemainingTime(type: PowerUpType): number {\n    const powerUp = this.powerUps.get(type);\n    return powerUp ? powerUp.remainingTime : 0;\n  }\n\n  /**\n   * Get all active power-ups\n   */\n  getActivePowerUps(): PowerUpType[] {\n    const active: PowerUpType[] = [];\n    this.powerUps.forEach((powerUp, type) => {\n      if (powerUp.active) {\n        active.push(type);\n      }\n    });\n    return active;\n  }\n\n  /**\n   * Check if player has shield (invincibility)\n   */\n  hasShield(): boolean {\n    return this.isActive(PowerUpType.SHIELD);\n  }\n\n  /**\n   * Check if magnet is active (auto-collect coins)\n   */\n  hasMagnet(): boolean {\n    return this.isActive(PowerUpType.MAGNET);\n  }\n\n  /**\n   * Check if score multiplier is active\n   */\n  hasMultiplier(): boolean {\n    return this.isActive(PowerUpType.MULTIPLIER);\n  }\n\n  /**\n   * Get current score multiplier value\n   */\n  getScoreMultiplier(): number {\n    return this.hasMultiplier() ? 2 : 1;\n  }\n\n  /**\n   * Reset all power-ups\n   */\n  reset(): void {\n    this.powerUps.forEach(powerUp => {\n      powerUp.active = false;\n      powerUp.remainingTime = 0;\n    });\n  }\n\n  /**\n   * Event system for power-up changes\n   */\n  on(event: string, callback: Function): void {\n    if (!this.listeners.has(event)) {\n      this.listeners.set(event, []);\n    }\n    this.listeners.get(event)!.push(callback);\n  }\n\n  private emit(event: string, ...args: any[]): void {\n    const callbacks = this.listeners.get(event);\n    if (callbacks) {\n      callbacks.forEach(cb => cb(...args));\n    }\n  }\n}\n","export class HealthSystem {\n  private maxHealth: number;\n  private currentHealth: number;\n  private callbacks: Map<string, Function> = new Map();\n\n  constructor(maxHealth: number = 3) {\n    this.maxHealth = maxHealth;\n    this.currentHealth = maxHealth;\n  }\n\n  /**\n   * Get current health\n   */\n  getCurrentHealth(): number {\n    return this.currentHealth;\n  }\n\n  /**\n   * Get max health\n   */\n  getMaxHealth(): number {\n    return this.maxHealth;\n  }\n\n  /**\n   * Take damage\n   */\n  takeDamage(amount: number = 1): boolean {\n    if (this.currentHealth <= 0) {\n      return false; // Already dead\n    }\n\n    this.currentHealth = Math.max(0, this.currentHealth - amount);\n    this.emit('healthChange', this.currentHealth);\n\n    if (this.currentHealth === 0) {\n      this.emit('death');\n      return true; // Died from this damage\n    }\n\n    return false;\n  }\n\n  /**\n   * Heal\n   */\n  heal(amount: number = 1): void {\n    this.currentHealth = Math.min(this.maxHealth, this.currentHealth + amount);\n    this.emit('healthChange', this.currentHealth);\n  }\n\n  /**\n   * Check if alive\n   */\n  isAlive(): boolean {\n    return this.currentHealth > 0;\n  }\n\n  /**\n   * Reset health to max\n   */\n  reset(): void {\n    this.currentHealth = this.maxHealth;\n    this.emit('healthChange', this.currentHealth);\n  }\n\n  /**\n   * Event system\n   */\n  on(event: string, callback: Function): void {\n    this.callbacks.set(event, callback);\n  }\n\n  private emit(event: string, ...args: any[]): void {\n    const callback = this.callbacks.get(event);\n    if (callback) {\n      callback(...args);\n    }\n  }\n}\n","import { ASSET_PATHS } from '../utils/Constants';\nimport { AudioSettings } from '../types';\n\nexport class AudioManager {\n  private sounds: Map<string, HTMLAudioElement> = new Map();\n  private bgm: HTMLAudioElement | null = null;\n\n  private settings: AudioSettings = {\n    musicEnabled: true,\n    musicVolume: 0.5,\n    sfxEnabled: true,\n    sfxVolume: 0.7,\n  };\n\n  private initialized: boolean = false;\n\n  constructor() {\n    this.loadSettings();\n  }\n\n  /**\n   * Initialize and preload all audio files\n   */\n  async init(): Promise<void> {\n    if (this.initialized) return;\n\n    console.log(' Initializing audio system...');\n\n    try {\n      // Load background music\n      console.log('Loading BGM from:', ASSET_PATHS.SOUNDS.BGM);\n      this.bgm = await this.loadAudio(ASSET_PATHS.SOUNDS.BGM);\n      this.bgm.loop = true;\n      this.bgm.volume = this.settings.musicVolume;\n      console.log(' BGM loaded');\n\n      // Load sound effects\n      console.log('Loading sound effects...');\n      await Promise.all([\n        this.loadSound('jump', ASSET_PATHS.SOUNDS.JUMP),\n        this.loadSound('coin', ASSET_PATHS.SOUNDS.COIN),\n        this.loadSound('fish', ASSET_PATHS.SOUNDS.FISH),\n        this.loadSound('hit', ASSET_PATHS.SOUNDS.HIT),\n        this.loadSound('powerup', ASSET_PATHS.SOUNDS.POWERUP),\n      ]);\n\n      this.initialized = true;\n      console.log(' Audio system initialized successfully');\n      console.log('Loaded sounds:', Array.from(this.sounds.keys()));\n    } catch (error) {\n      console.error(' Audio initialization failed:', error);\n      this.initialized = true; // Continue anyway\n    }\n  }\n\n  /**\n   * Load a single audio file\n   */\n  private async loadAudio(src: string): Promise<HTMLAudioElement> {\n    return new Promise((resolve) => {\n      const audio = new Audio();\n      audio.addEventListener('canplaythrough', () => resolve(audio), { once: true });\n      audio.addEventListener('error', (e) => {\n        console.warn(`Failed to load audio: ${src}`, e);\n        resolve(audio); // Resolve anyway with a silent audio element\n      });\n      audio.src = src;\n      audio.load();\n    });\n  }\n\n  /**\n   * Load and store a sound effect\n   */\n  private async loadSound(name: string, src: string): Promise<void> {\n    const audio = await this.loadAudio(src);\n    audio.volume = this.settings.sfxVolume;\n    this.sounds.set(name, audio);\n  }\n\n  /**\n   * Play a sound effect\n   */\n  playSFX(name: string): void {\n    if (!this.settings.sfxEnabled) return;\n\n    const sound = this.sounds.get(name);\n    if (sound) {\n      // Clone the audio to allow overlapping sounds\n      const clone = sound.cloneNode() as HTMLAudioElement;\n      clone.volume = this.settings.sfxVolume;\n      clone.play().catch(e => console.warn('Failed to play sound:', name, e));\n    }\n  }\n\n  /**\n   * Play background music\n   */\n  playMusic(): void {\n    if (!this.settings.musicEnabled) {\n      console.log('Music disabled');\n      return;\n    }\n\n    if (!this.bgm) {\n      console.warn(' BGM not loaded');\n      return;\n    }\n\n    console.log(' Attempting to play music...');\n    this.bgm.currentTime = 0;\n    this.bgm.play()\n      .then(() => console.log(' Music playing'))\n      .catch(e => {\n        console.warn(' Failed to play music (browser autoplay policy):', e.message);\n        console.log(' Music will play after user interaction');\n      });\n  }\n\n  /**\n   * Stop background music\n   */\n  stopMusic(): void {\n    if (this.bgm) {\n      this.bgm.pause();\n      this.bgm.currentTime = 0;\n    }\n  }\n\n  /**\n   * Pause background music\n   */\n  pauseMusic(): void {\n    if (this.bgm) {\n      this.bgm.pause();\n    }\n  }\n\n  /**\n   * Resume background music\n   */\n  resumeMusic(): void {\n    if (this.settings.musicEnabled && this.bgm) {\n      this.bgm.play().catch(e => console.warn('Failed to resume music', e));\n    }\n  }\n\n  /**\n   * Set music volume\n   */\n  setMusicVolume(volume: number): void {\n    this.settings.musicVolume = Math.max(0, Math.min(1, volume));\n    if (this.bgm) {\n      this.bgm.volume = this.settings.musicVolume;\n    }\n    this.saveSettings();\n  }\n\n  /**\n   * Set SFX volume\n   */\n  setSFXVolume(volume: number): void {\n    this.settings.sfxVolume = Math.max(0, Math.min(1, volume));\n    this.sounds.forEach(sound => {\n      sound.volume = this.settings.sfxVolume;\n    });\n    this.saveSettings();\n  }\n\n  /**\n   * Toggle music on/off\n   */\n  toggleMusic(enabled?: boolean): void {\n    this.settings.musicEnabled = enabled !== undefined ? enabled : !this.settings.musicEnabled;\n\n    if (this.settings.musicEnabled) {\n      this.playMusic();\n    } else {\n      this.stopMusic();\n    }\n\n    this.saveSettings();\n  }\n\n  /**\n   * Toggle SFX on/off\n   */\n  toggleSFX(enabled?: boolean): void {\n    this.settings.sfxEnabled = enabled !== undefined ? enabled : !this.settings.sfxEnabled;\n    this.saveSettings();\n  }\n\n  /**\n   * Get current audio settings\n   */\n  getSettings(): Readonly<AudioSettings> {\n    return { ...this.settings };\n  }\n\n  /**\n   * Save settings to localStorage\n   */\n  private saveSettings(): void {\n    localStorage.setItem('cat-runrun-audio', JSON.stringify(this.settings));\n  }\n\n  /**\n   * Load settings from localStorage\n   */\n  private loadSettings(): void {\n    const stored = localStorage.getItem('cat-runrun-audio');\n    if (stored) {\n      try {\n        this.settings = JSON.parse(stored);\n      } catch (e) {\n        console.warn('Failed to load audio settings', e);\n      }\n    }\n  }\n\n  /**\n   * Dispose of all audio resources\n   */\n  dispose(): void {\n    this.stopMusic();\n    this.sounds.clear();\n    this.bgm = null;\n  }\n}\n","import { GameStats, PowerUpType, LeaderboardEntry, SkinData } from '../types';\n\nexport class UIManager {\n  // Menu elements\n  private mainMenu: HTMLElement;\n  private tutorialMenu: HTMLElement;\n  private shopMenu: HTMLElement;\n  private leaderboardMenu: HTMLElement;\n  private gameoverMenu: HTMLElement;\n  private pauseMenu: HTMLElement;\n  private loadingScreen: HTMLElement;\n\n  // HUD elements\n  private hud: HTMLElement;\n  private hudScore: HTMLElement;\n  private hudDistance: HTMLElement;\n  private hudCoins: HTMLElement;\n\n  // Power-up indicators\n  private powerupMagnet: HTMLElement;\n  private powerupMultiplier: HTMLElement;\n  private powerupShield: HTMLElement;\n\n  // Callbacks\n  private callbacks: Map<string, Function> = new Map();\n\n  constructor() {\n    // Get menu elements\n    this.mainMenu = this.getElement('main-menu');\n    this.tutorialMenu = this.getElement('tutorial-menu');\n    this.shopMenu = this.getElement('shop-menu');\n    this.leaderboardMenu = this.getElement('leaderboard-menu');\n    this.gameoverMenu = this.getElement('gameover-menu');\n    this.pauseMenu = this.getElement('pause-menu');\n    this.loadingScreen = this.getElement('loading-screen');\n\n    // Get HUD elements\n    this.hud = this.getElement('hud');\n    this.hudScore = this.getElement('hud-score');\n    this.hudDistance = this.getElement('hud-distance');\n    this.hudCoins = this.getElement('hud-coins');\n\n    // Get power-up indicators\n    this.powerupMagnet = this.getElement('powerup-magnet');\n    this.powerupMultiplier = this.getElement('powerup-multiplier');\n    this.powerupShield = this.getElement('powerup-shield');\n\n    this.setupEventListeners();\n  }\n\n  private getElement(id: string): HTMLElement {\n    const element = document.getElementById(id);\n    if (!element) {\n      throw new Error(`UI element not found: ${id}`);\n    }\n    return element;\n  }\n\n  /**\n   * Add both click and touchstart handlers for better mobile support\n   * Prevents double-firing by tracking which event fired first\n   */\n  private addClickHandler(elementId: string, handler: () => void): void {\n    const element = this.getElement(elementId);\n    let touchHandled = false;\n\n    console.log(`Setting up click handler for: ${elementId}`);\n\n    // Handle touch events (mobile)\n    element.addEventListener('touchstart', (e) => {\n      console.log(`Touch event on ${elementId}`);\n      e.preventDefault();\n      touchHandled = true;\n      handler();\n\n      // Reset flag after a short delay\n      setTimeout(() => {\n        touchHandled = false;\n      }, 300);\n    }, { passive: false });\n\n    // Handle click events (desktop and mobile fallback)\n    element.addEventListener('click', () => {\n      console.log(`Click event on ${elementId}, touchHandled: ${touchHandled}`);\n      if (!touchHandled) {\n        handler();\n      }\n    });\n  }\n\n  private setupEventListeners(): void {\n    // Main menu buttons - add both click and touchstart for better mobile support\n    this.addClickHandler('btn-start', () => this.emit('startGame'));\n    this.addClickHandler('btn-tutorial', () => this.showTutorial());\n    this.addClickHandler('btn-leaderboard', () => this.showLeaderboard());\n    this.addClickHandler('btn-shop', () => this.showShop());\n\n    // Tutorial menu\n    this.addClickHandler('btn-back-tutorial', () => this.showMainMenu());\n\n    // Shop menu\n    this.addClickHandler('btn-back-shop', () => this.showMainMenu());\n\n    // Leaderboard menu\n    this.addClickHandler('btn-back-leaderboard', () => this.showMainMenu());\n\n    // Game over menu\n    this.addClickHandler('btn-restart', () => this.emit('restart'));\n    this.addClickHandler('btn-menu', () => {\n      this.showMainMenu();\n      this.emit('returnToMenu');\n    });\n    this.addClickHandler('btn-share', () => this.shareScore());\n\n    // Pause menu\n    this.addClickHandler('btn-resume', () => this.emit('resume'));\n    this.addClickHandler('btn-quit', () => {\n      this.showMainMenu();\n      this.emit('quit');\n    });\n\n    // Audio controls\n    const toggleMusic = this.getElement('toggle-music') as HTMLInputElement;\n    const toggleSFX = this.getElement('toggle-sfx') as HTMLInputElement;\n\n    toggleMusic.addEventListener('change', () => {\n      this.emit('toggleMusic', toggleMusic.checked);\n    });\n\n    toggleSFX.addEventListener('change', () => {\n      this.emit('toggleSFX', toggleSFX.checked);\n    });\n  }\n\n  /**\n   * Show main menu\n   */\n  showMainMenu(): void {\n    this.hideAllMenus();\n    this.mainMenu.classList.add('active');\n    this.hud.classList.add('hidden');\n  }\n\n  /**\n   * Show tutorial\n   */\n  showTutorial(): void {\n    this.hideAllMenus();\n    this.tutorialMenu.classList.add('active');\n  }\n\n  /**\n   * Show shop\n   */\n  showShop(): void {\n    this.hideAllMenus();\n    this.shopMenu.classList.add('active');\n    this.populateShop();\n  }\n\n  /**\n   * Show leaderboard\n   */\n  showLeaderboard(): void {\n    this.hideAllMenus();\n    this.leaderboardMenu.classList.add('active');\n    this.populateLeaderboard();\n  }\n\n  /**\n   * Show game over screen\n   */\n  showGameOver(stats: GameStats, highScore: number): void {\n    this.hideAllMenus();\n    this.hud.classList.add('hidden');\n    this.gameoverMenu.classList.add('active');\n\n    // Update game over stats\n    this.getElement('final-score').textContent = stats.score.toString();\n    this.getElement('final-distance').textContent = Math.floor(stats.distance) + 'm';\n    this.getElement('final-coins').textContent = stats.coins.toString();\n    this.getElement('best-score').textContent = highScore.toString();\n  }\n\n  /**\n   * Show pause menu\n   */\n  showPauseMenu(): void {\n    this.pauseMenu.classList.add('active');\n  }\n\n  /**\n   * Hide pause menu\n   */\n  hidePauseMenu(): void {\n    this.pauseMenu.classList.remove('active');\n  }\n\n  /**\n   * Show HUD (in-game UI)\n   */\n  showHUD(): void {\n    this.hideAllMenus();\n    this.hud.classList.remove('hidden');\n  }\n\n  /**\n   * Hide all menus\n   */\n  private hideAllMenus(): void {\n    [\n      this.mainMenu,\n      this.tutorialMenu,\n      this.shopMenu,\n      this.leaderboardMenu,\n      this.gameoverMenu,\n      this.pauseMenu,\n    ].forEach(menu => menu.classList.remove('active'));\n  }\n\n  /**\n   * Update HUD score\n   */\n  updateScore(score: number): void {\n    this.hudScore.textContent = score.toString();\n  }\n\n  /**\n   * Update HUD distance\n   */\n  updateDistance(distance: number): void {\n    this.hudDistance.textContent = Math.floor(distance) + 'm';\n  }\n\n  /**\n   * Update HUD coins\n   */\n  updateCoins(coins: number): void {\n    this.hudCoins.textContent = coins.toString();\n  }\n\n  /**\n   * Update health hearts display\n   */\n  updateHealth(currentHealth: number, maxHealth: number = 3): void {\n    for (let i = 1; i <= maxHealth; i++) {\n      const heart = document.getElementById(`heart-${i}`);\n      if (heart) {\n        if (i <= currentHealth) {\n          heart.classList.remove('lost');\n        } else {\n          heart.classList.add('lost');\n        }\n      }\n    }\n  }\n\n  /**\n   * Show power-up indicator\n   */\n  showPowerUp(type: PowerUpType, duration: number): void {\n    let element: HTMLElement;\n    switch (type) {\n      case PowerUpType.MAGNET:\n        element = this.powerupMagnet;\n        break;\n      case PowerUpType.MULTIPLIER:\n        element = this.powerupMultiplier;\n        break;\n      case PowerUpType.SHIELD:\n        element = this.powerupShield;\n        break;\n    }\n\n    element.classList.remove('hidden');\n    this.updatePowerUpTimer(type, duration);\n  }\n\n  /**\n   * Hide power-up indicator\n   */\n  hidePowerUp(type: PowerUpType): void {\n    let element: HTMLElement;\n    switch (type) {\n      case PowerUpType.MAGNET:\n        element = this.powerupMagnet;\n        break;\n      case PowerUpType.MULTIPLIER:\n        element = this.powerupMultiplier;\n        break;\n      case PowerUpType.SHIELD:\n        element = this.powerupShield;\n        break;\n    }\n\n    element.classList.add('hidden');\n  }\n\n  /**\n   * Update power-up timer\n   */\n  updatePowerUpTimer(type: PowerUpType, remainingTime: number): void {\n    let element: HTMLElement;\n    switch (type) {\n      case PowerUpType.MAGNET:\n        element = this.powerupMagnet;\n        break;\n      case PowerUpType.MULTIPLIER:\n        element = this.powerupMultiplier;\n        break;\n      case PowerUpType.SHIELD:\n        element = this.powerupShield;\n        break;\n    }\n\n    const timerElement = element.querySelector('.powerup-timer');\n    if (timerElement) {\n      timerElement.textContent = Math.ceil(remainingTime) + 's';\n    }\n  }\n\n  /**\n   * Update loading progress\n   */\n  updateLoadingProgress(progress: number, text?: string): void {\n    const progressBar = this.getElement('loading-progress');\n    progressBar.style.width = `${progress * 100}%`;\n\n    if (text) {\n      this.getElement('loading-text').textContent = text;\n    }\n  }\n\n  /**\n   * Hide loading screen\n   */\n  hideLoadingScreen(): void {\n    console.log('Hiding loading screen');\n    this.loadingScreen.classList.add('hidden');\n    // Also set display none to ensure it doesn't block clicks\n    this.loadingScreen.style.display = 'none';\n  }\n\n  /**\n   * Populate shop with skins\n   */\n  private populateShop(): void {\n    const skinsList = this.getElement('skins-list');\n    skinsList.innerHTML = '';\n\n    // Mock skins data - would come from game data in real implementation\n    const skins: SkinData[] = [\n      { id: 'orange', name: 'Orange Cat', price: 0, unlocked: true, color: 0xffa500 },\n      { id: 'white', name: 'White Cat', price: 100, unlocked: false, color: 0xffffff },\n      { id: 'black', name: 'Black Cat', price: 200, unlocked: false, color: 0x000000 },\n      { id: 'tabby', name: 'Tabby Cat', price: 300, unlocked: false, color: 0x8b4513 },\n      { id: 'calico', name: 'Calico Cat', price: 500, unlocked: false, color: 0xff6347 },\n      { id: 'siamese', name: 'Siamese Cat', price: 750, unlocked: false, color: 0xf5deb3 },\n    ];\n\n    skins.forEach(skin => {\n      const skinElement = document.createElement('div');\n      skinElement.className = 'skin-item';\n      if (!skin.unlocked) skinElement.classList.add('locked');\n\n      skinElement.innerHTML = `\n        <div class=\"skin-preview\" style=\"background-color: #${skin.color?.toString(16).padStart(6, '0')}\"></div>\n        <div class=\"skin-name\">${skin.name}</div>\n        <div class=\"skin-price\">${skin.unlocked ? 'Owned' : skin.price + ' coins'}</div>\n      `;\n\n      skinElement.addEventListener('click', () => {\n        if (skin.unlocked) {\n          this.emit('selectSkin', skin.id);\n        }\n      });\n\n      skinsList.appendChild(skinElement);\n    });\n  }\n\n  /**\n   * Populate leaderboard\n   */\n  private populateLeaderboard(): void {\n    const leaderboardList = this.getElement('leaderboard-list');\n    leaderboardList.innerHTML = '';\n\n    // Mock leaderboard data - would come from server in real implementation\n    const entries: LeaderboardEntry[] = [\n      { rank: 1, playerName: 'Player 1', score: 5000, distance: 500, date: '2025-12-08' },\n      { rank: 2, playerName: 'Player 2', score: 4500, distance: 450, date: '2025-12-07' },\n      { rank: 3, playerName: 'Player 3', score: 4000, distance: 400, date: '2025-12-06' },\n      { rank: 4, playerName: 'Player 4', score: 3500, distance: 350, date: '2025-12-05' },\n      { rank: 5, playerName: 'Player 5', score: 3000, distance: 300, date: '2025-12-04' },\n    ];\n\n    entries.forEach(entry => {\n      const entryElement = document.createElement('div');\n      entryElement.className = 'leaderboard-item';\n      if (entry.rank <= 3) entryElement.classList.add('top-3');\n\n      entryElement.innerHTML = `\n        <div class=\"leaderboard-rank\">#${entry.rank}</div>\n        <div class=\"leaderboard-player\">${entry.playerName}</div>\n        <div class=\"leaderboard-score\">${entry.score}</div>\n      `;\n\n      leaderboardList.appendChild(entryElement);\n    });\n  }\n\n  /**\n   * Share score using Web Share API\n   */\n  private async shareScore(): Promise<void> {\n    const score = this.getElement('final-score').textContent;\n    const distance = this.getElement('final-distance').textContent;\n\n    if (navigator.share) {\n      try {\n        await navigator.share({\n          title: 'Cat Run Run',\n          text: `I scored ${score} points and ran ${distance} in Cat Run Run!`,\n          url: window.location.href,\n        });\n      } catch (err) {\n        console.log('Share cancelled or failed', err);\n      }\n    } else {\n      // Fallback - copy to clipboard\n      const text = `I scored ${score} points and ran ${distance} in Cat Run Run!`;\n      navigator.clipboard.writeText(text).then(() => {\n        alert('Score copied to clipboard!');\n      });\n    }\n  }\n\n  /**\n   * Event system\n   */\n  on(event: string, callback: Function): void {\n    this.callbacks.set(event, callback);\n  }\n\n  private emit(event: string, ...args: any[]): void {\n    console.log(`Emitting event: ${event}`, args);\n    const callback = this.callbacks.get(event);\n    if (callback) {\n      callback(...args);\n    } else {\n      console.warn(`No callback registered for event: ${event}`);\n    }\n  }\n}\n","import { GameScene } from './scenes/GameScene';\nimport { InputManager } from './systems/InputManager';\nimport { ScoreSystem } from './systems/ScoreSystem';\nimport { PowerUpSystem } from './systems/PowerUpSystem';\nimport { HealthSystem } from './systems/HealthSystem';\nimport { AudioManager } from './systems/AudioManager';\nimport { UIManager } from './ui/UIManager';\nimport { GameState, PowerUpType, CollectibleType } from './types';\nimport { GAME_CONFIG } from './utils/Constants';\nimport { Obstacle } from './entities/Obstacle';\nimport { Collectible } from './entities/Collectible';\n\nexport class Game {\n  private gameScene: GameScene;\n  private inputManager: InputManager;\n  private scoreSystem: ScoreSystem;\n  private powerUpSystem: PowerUpSystem;\n  private healthSystem: HealthSystem;\n  private audioManager: AudioManager;\n  private uiManager: UIManager;\n\n  private state: GameState = GameState.LOADING;\n  private lastTime: number = 0;\n  private animationFrameId: number = 0;\n\n  constructor(container: HTMLElement) {\n    // Initialize systems\n    this.gameScene = new GameScene(container);\n    this.inputManager = new InputManager();\n    this.scoreSystem = new ScoreSystem();\n    this.powerUpSystem = new PowerUpSystem();\n    this.healthSystem = new HealthSystem(3); // 3 hearts\n    this.audioManager = new AudioManager();\n    this.uiManager = new UIManager();\n\n    // Setup callbacks\n    this.setupCallbacks();\n\n    // Load game\n    this.init();\n  }\n\n  private async init(): Promise<void> {\n    try {\n      // Load audio\n      await this.audioManager.init();\n      this.uiManager.updateLoadingProgress(0.5, 'Loading audio...');\n\n      // Load any other assets here\n      this.uiManager.updateLoadingProgress(1, 'Ready!');\n\n      // Wait a bit to show \"Ready!\"\n      await new Promise(resolve => setTimeout(resolve, 500));\n\n      // Hide loading screen and show main menu\n      this.uiManager.hideLoadingScreen();\n      this.setState(GameState.MENU);\n      this.uiManager.showMainMenu();\n    } catch (error) {\n      console.error('Failed to initialize game:', error);\n      alert('Failed to load game. Please refresh the page.');\n    }\n  }\n\n  private setupCallbacks(): void {\n    // UI callbacks\n    this.uiManager.on('startGame', () => this.startGame());\n    this.uiManager.on('restart', () => this.restartGame());\n    this.uiManager.on('resume', () => this.resumeGame());\n    this.uiManager.on('quit', () => this.quitToMenu());\n    this.uiManager.on('returnToMenu', () => this.quitToMenu());\n    this.uiManager.on('toggleMusic', (enabled: boolean) => this.audioManager.toggleMusic(enabled));\n    this.uiManager.on('toggleSFX', (enabled: boolean) => this.audioManager.toggleSFX(enabled));\n\n    // Score system callbacks\n    this.scoreSystem.on('scoreChange', (score: number) => this.uiManager.updateScore(score));\n    this.scoreSystem.on('distanceChange', (distance: number) => this.uiManager.updateDistance(distance));\n    this.scoreSystem.on('coinCollect', (coins: number) => this.uiManager.updateCoins(coins));\n\n    // Health system callbacks\n    this.healthSystem.on('healthChange', (health: number) => {\n      this.uiManager.updateHealth(health, this.healthSystem.getMaxHealth());\n    });\n    this.healthSystem.on('death', () => this.gameOver());\n\n    // Power-up system callbacks\n    this.powerUpSystem.on('powerUpActivate', (type: PowerUpType) => {\n      this.onPowerUpActivate(type);\n    });\n\n    this.powerUpSystem.on('powerUpExpire', (type: PowerUpType) => {\n      this.onPowerUpExpire(type);\n    });\n\n    this.powerUpSystem.on('powerUpUpdate', (type: PowerUpType, remainingTime: number) => {\n      this.uiManager.updatePowerUpTimer(type, remainingTime);\n    });\n\n    // Scene collision callback\n    this.gameScene.setCollisionCallback((type, object) => {\n      this.handleCollision(type, object);\n    });\n  }\n\n  private setState(newState: GameState): void {\n    const oldState = this.state;\n    this.state = newState;\n    console.log(`Game state: ${oldState} -> ${newState}`);\n  }\n\n  /**\n   * Start a new game\n   */\n  private startGame(): void {\n    this.setState(GameState.PLAYING);\n    this.uiManager.showHUD();\n\n    // Reset everything\n    this.gameScene.reset();\n    this.scoreSystem.reset();\n    this.powerUpSystem.reset();\n    this.healthSystem.reset();\n    this.inputManager.reset();\n\n    // Enable input handling\n    this.inputManager.setGamePlaying(true);\n\n    // Load total coins from localStorage\n    this.scoreSystem.loadTotalCoins();\n\n    // Start background music\n    this.audioManager.playMusic();\n\n    // Start game loop\n    this.lastTime = performance.now();\n    this.gameLoop();\n  }\n\n  /**\n   * Restart game after game over\n   */\n  private restartGame(): void {\n    this.startGame();\n  }\n\n  /**\n   * Resume game from pause\n   */\n  private resumeGame(): void {\n    this.setState(GameState.PLAYING);\n    this.uiManager.hidePauseMenu();\n    this.audioManager.resumeMusic();\n\n    // Re-enable input handling\n    this.inputManager.setGamePlaying(true);\n\n    this.lastTime = performance.now();\n    this.gameLoop();\n  }\n\n  /**\n   * Quit to main menu\n   */\n  private quitToMenu(): void {\n    this.setState(GameState.MENU);\n    this.audioManager.stopMusic();\n\n    // Disable input handling when in menu\n    this.inputManager.setGamePlaying(false);\n\n    cancelAnimationFrame(this.animationFrameId);\n  }\n\n  /**\n   * Pause game\n   */\n  private pauseGame(): void {\n    if (this.state !== GameState.PLAYING) return;\n\n    this.setState(GameState.PAUSED);\n    this.uiManager.showPauseMenu();\n    this.audioManager.pauseMusic();\n\n    // Disable input handling when paused\n    this.inputManager.setGamePlaying(false);\n\n    cancelAnimationFrame(this.animationFrameId);\n  }\n\n  /**\n   * Game over\n   */\n  private gameOver(): void {\n    this.setState(GameState.GAME_OVER);\n\n    // Disable input handling when game is over\n    this.inputManager.setGamePlaying(false);\n\n    // Save high score\n    const highScore = this.scoreSystem.saveHighScore();\n\n    // Save total coins\n    this.scoreSystem.saveTotalCoins();\n\n    // Show game over UI\n    this.uiManager.showGameOver(this.scoreSystem.getStats(), highScore);\n\n    // Play hit sound\n    this.audioManager.playSFX('hit');\n\n    // Stop music\n    this.audioManager.stopMusic();\n\n    // Stop game loop\n    cancelAnimationFrame(this.animationFrameId);\n  }\n\n  /**\n   * Main game loop\n   */\n  private gameLoop = (): void => {\n    if (this.state !== GameState.PLAYING) return;\n\n    const currentTime = performance.now();\n    const deltaTime = Math.min((currentTime - this.lastTime) / 1000, 0.1); // Cap at 100ms\n    this.lastTime = currentTime;\n\n    // Handle input\n    this.handleInput();\n\n    // Update game systems\n    this.update(deltaTime);\n\n    // Render\n    this.gameScene.render();\n\n    // Continue loop\n    this.animationFrameId = requestAnimationFrame(this.gameLoop);\n  };\n\n  /**\n   * Handle player input\n   */\n  private handleInput(): void {\n    const input = this.inputManager.getInputState();\n    const player = this.gameScene.getPlayer();\n\n    // Lane switching\n    if (input.left) {\n      if (player.moveLeft()) {\n        this.audioManager.playSFX('jump'); // Reuse jump sound for lane switch\n      }\n      this.inputManager.reset();\n    } else if (input.right) {\n      if (player.moveRight()) {\n        this.audioManager.playSFX('jump');\n      }\n      this.inputManager.reset();\n    }\n\n    // Jump\n    if (input.jump) {\n      if (player.jump()) {\n        this.audioManager.playSFX('jump');\n      }\n      this.inputManager.reset();\n    }\n\n    // Slide\n    if (input.slide) {\n      if (player.slide()) {\n        this.audioManager.playSFX('jump'); // Reuse sound\n      }\n      this.inputManager.reset();\n    }\n\n    // Pause\n    if (input.pause) {\n      this.pauseGame();\n      this.inputManager.reset();\n    }\n  }\n\n  /**\n   * Update game state\n   */\n  private update(deltaTime: number): void {\n    // Update scene\n    this.gameScene.update(deltaTime);\n\n    // Update score system\n    this.scoreSystem.update(deltaTime);\n\n    // Update power-up system\n    this.powerUpSystem.update(deltaTime);\n\n    // Update game speed based on progress\n    this.updateGameSpeed();\n\n    // Update player invincibility from shield\n    const player = this.gameScene.getPlayer();\n    player.setInvincible(this.powerUpSystem.hasShield());\n\n    // Auto-collect coins with magnet\n    if (this.powerUpSystem.hasMagnet()) {\n      // This would be implemented in scene to attract nearby coins\n      // For now, magnet just makes collection radius larger\n    }\n\n    // Update score multiplier\n    this.scoreSystem.setMultiplier(this.powerUpSystem.getScoreMultiplier());\n  }\n\n  /**\n   * Update game speed based on distance\n   */\n  private updateGameSpeed(): void {\n    const segmentsPassed = this.scoreSystem.getStat('segmentsPassed');\n    const speedIncrements = Math.floor(segmentsPassed / GAME_CONFIG.SPEED_INCREMENT_INTERVAL);\n    const newSpeed = Math.min(\n      GAME_CONFIG.BASE_SPEED + speedIncrements * GAME_CONFIG.SPEED_INCREMENT,\n      GAME_CONFIG.MAX_SPEED\n    );\n\n    this.scoreSystem.setSpeed(newSpeed);\n    this.gameScene.setSpeed(newSpeed);\n  }\n\n  /**\n   * Handle collision with obstacles or collectibles\n   */\n  private handleCollision(type: 'obstacle' | 'collectible', object: Obstacle | Collectible): void {\n    if (type === 'obstacle') {\n      console.log('handleCollision called for obstacle');\n      const player = this.gameScene.getPlayer();\n\n      if (!player.isInvincible()) {\n        console.log('Player not invincible, taking damage. Current health:', this.healthSystem.getCurrentHealth());\n        // Hit obstacle - take damage\n        player.hit();\n        const died = this.healthSystem.takeDamage(1);\n        console.log('After damage. Current health:', this.healthSystem.getCurrentHealth(), 'Died:', died);\n        this.audioManager.playSFX('hit');\n        // Game over is now handled by healthSystem's 'death' event\n      } else {\n        console.log('Player is invincible, no damage taken');\n      }\n    } else if (type === 'collectible') {\n      const collectible = object as Collectible;\n\n      switch (collectible.getType()) {\n        case CollectibleType.COIN:\n          this.scoreSystem.collectCoin();\n          this.audioManager.playSFX('coin');\n          break;\n\n        case CollectibleType.FISH:\n          this.scoreSystem.collectFish();\n          this.audioManager.playSFX('fish');\n          break;\n\n        case CollectibleType.POWERUP_MAGNET:\n          this.powerUpSystem.activatePowerUp(PowerUpType.MAGNET);\n          this.audioManager.playSFX('powerup');\n          break;\n\n        case CollectibleType.POWERUP_MULTIPLIER:\n          this.powerUpSystem.activatePowerUp(PowerUpType.MULTIPLIER);\n          this.audioManager.playSFX('powerup');\n          break;\n\n        case CollectibleType.POWERUP_SHIELD:\n          this.powerUpSystem.activatePowerUp(PowerUpType.SHIELD);\n          this.audioManager.playSFX('powerup');\n          break;\n      }\n    }\n  }\n\n  /**\n   * Handle power-up activation\n   */\n  private onPowerUpActivate(type: PowerUpType): void {\n    const duration = this.powerUpSystem.getRemainingTime(type);\n    this.uiManager.showPowerUp(type, duration);\n  }\n\n  /**\n   * Handle power-up expiration\n   */\n  private onPowerUpExpire(type: PowerUpType): void {\n    this.uiManager.hidePowerUp(type);\n  }\n\n  /**\n   * Dispose of game resources\n   */\n  dispose(): void {\n    cancelAnimationFrame(this.animationFrameId);\n    this.gameScene.dispose();\n    this.inputManager.dispose();\n    this.audioManager.dispose();\n  }\n}\n","import { Game } from './Game';\n\n// Wait for DOM to be ready\ndocument.addEventListener('DOMContentLoaded', () => {\n  const container = document.getElementById('game-container');\n\n  if (!container) {\n    console.error('Game container not found!');\n    return;\n  }\n\n  // Create and start the game\n  const game = new Game(container);\n\n  // Handle page visibility (pause when tab is hidden)\n  document.addEventListener('visibilitychange', () => {\n    if (document.hidden) {\n      // Game will handle pausing internally\n      console.log('Page hidden');\n    } else {\n      console.log('Page visible');\n    }\n  });\n\n  // Expose game instance for debugging (optional)\n  (window as any).game = game;\n\n  console.log('Cat Run Run initialized!');\n});\n"],"names":["GAME_CONFIG","BASE_PATH","ASSET_PATHS","COLORS","ANIMATION_NAMES","GameState","PowerUpType","ObstacleType","CollectibleType","Player","scene","__publicField","THREE.Vector3","THREE.Box3","cat","THREE.Group","bodyGeometry","THREE.BoxGeometry","bodyMaterial","THREE.MeshStandardMaterial","body","THREE.Mesh","headGeometry","THREE.SphereGeometry","head","earGeometry","THREE.ConeGeometry","leftEar","rightEar","tailGeometry","THREE.CylinderGeometry","tail","legGeometry","legMaterial","x","y","z","leg","deltaTime","targetX","currentX","direction","moveAmount","bobAmount","invincible","child","THREE.Color","originalColor","mat","Obstacle","type","material","geometry","mesh","pillarGeometry","pillarMaterial","leftPillar","rightPillar","lane","zPosition","_deltaTime","size","active","Collectible","group","coin","THREE.TorusGeometry","magnet","glowGeometry","glowMaterial","THREE.MeshBasicMaterial","glow","box","THREE.OctahedronGeometry","shield","floatOffset","LevelGenerator","config","numObstacles","usedPositions","obstacleType","position","key","obs","laneToClear","pattern","coinCount","spacing","i","currentLane","powerUpTypes","rand","types","CollisionSystem","obj1","obj2","box1","box2","distance","combinedRadius","obj1Lane","obj1Z","obj2Lane","obj2Z","threshold","origin","objects","range","obj","maxDistance","THREE.Raycaster","ObjectPool","factory","initialSize","maxSize","GameScene","container","THREE.Scene","THREE.Fog","THREE.PerspectiveCamera","THREE.WebGLRenderer","THREE.PCFSoftShadowMap","hemiLight","THREE.HemisphereLight","dirLight","THREE.DirectionalLight","pool","obstacle","collectible","segment","groundGeometry","THREE.PlaneGeometry","groundMaterial","ground","lineGeometry","lineMaterial","line","baseZ","obstacleConfig","collectibleConfig","scrollAmount","playerZ","farthestSegmentZ","_a","oldestSegment","playerLane","obstacleWorldZ","obstacleWorldPos","collectibleWorldZ","collectibleWorldPos","speed","callback","object","InputManager","touch","deltaX","deltaY","absDeltaX","absDeltaY","action","input","isPlaying","ScoreSystem","distanceGained","points","finalPoints","value","comboBonus","multiplier","totalCoins","event","args","callbacks","cb","currentHigh","stored","PowerUpSystem","powerUp","HealthSystem","maxHealth","amount","AudioManager","error","src","resolve","audio","e","name","sound","clone","volume","enabled","UIManager","id","element","elementId","handler","touchHandled","toggleMusic","toggleSFX","stats","highScore","menu","score","coins","currentHealth","heart","duration","remainingTime","timerElement","progress","text","progressBar","skinsList","skin","skinElement","leaderboardList","entry","entryElement","err","Game","currentTime","health","newState","oldState","player","segmentsPassed","speedIncrements","newSpeed","died","game"],"mappings":"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"}